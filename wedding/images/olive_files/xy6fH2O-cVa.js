/*!CK:3842989121!*//*1455564528,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["FN4II"]); }

__d('FeedTagSuggest',['ArbiterMixin','AsyncRequest','CSS','Event','mixin','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;n=babelHelpers.inherits(p,l(h));o=n&&n.prototype;function p(q,r,s,t,u,v,w,x,y,z){'use strict';o.constructor.call(this);this.suggest=q;this.$FeedTagSuggest1=w;this.$FeedTagSuggest2=x;this.$FeedTagSuggest3=y;this.$FeedTagSuggest4=r;this.$FeedTagSuggest5=v;this.$FeedTagSuggest6=u;this.$FeedTagSuggest7=s;this.$FeedTagSuggest8=t;this.$FeedTagSuggest9=z;this.$FeedTagSuggest10=new m();this.$FeedTagSuggest10.addSubscriptions(k.listen(this.$FeedTagSuggest5,'click',this.dismissSuggestion.bind(this,'no')),k.listen(this.$FeedTagSuggest6,'click',this.acceptTagSuggestion.bind(this)));if(this.$FeedTagSuggest4)this.$FeedTagSuggest10.addSubscriptions(k.listen(this.$FeedTagSuggest4,'click',this.dismissSuggestion.bind(this,'close')));}p.prototype.dismissSuggestion=function(q){'use strict';var r=this.$FeedTagSuggest9.feed_type;new i().setURI('/ajax/dismiss_tag_suggest.php').setMethod('POST').setData({facebox_logs:[{facebox:this.$FeedTagSuggest2,log_data:this.$FeedTagSuggest9}],closing_source:r,closing_action:q}).setAllowCrossPageTransition(true).send();this.inform('remove');};p.prototype.tagSaveSuccess=function(q){'use strict';this.inform('remove');};p.prototype.acceptTagSuggestion=function(){'use strict';new i().setURI('/ajax/photo_feed_tagging_ajax.php').setMethod('POST').setData({photo_id:this.$FeedTagSuggest1,facebox_id:this.$FeedTagSuggest2,subject_id:this.$FeedTagSuggest3,log_data:this.$FeedTagSuggest9}).setErrorHandler(this.dismissSuggestion.bind(this,'err')).setAllowCrossPageTransition(true).setHandler(this.tagSaveSuccess.bind(this)).send();if(this.$FeedTagSuggest8){j.hide(this.$FeedTagSuggest7);j.show(this.$FeedTagSuggest8);}};p.prototype.cleanup=function(){'use strict';this.$FeedTagSuggest10.release();};f.exports=p;},null);
__d('LitestandTagSuggestContainer',['Animation','CSS','cx','csx','DOM','DOMQuery','Event','invariant','JSXDOM','Rect','SubscriptionsHandler','Style'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();function t(u,v,w,x){'use strict';this.$LitestandTagSuggestContainer1=new r();this.$LitestandTagSuggestContainer1.engage();this.$LitestandTagSuggestContainer2=u;this.$LitestandTagSuggestContainer3=w;this.$LitestandTagSuggestContainer4=x;i.show(this.$LitestandTagSuggestContainer2);var y=new q(w).w(),z=m.scry(u,"._5cne"),aa=0;for(var ba=0;ba<z.length;ba++){i.show(z[ba]);var ca=new q(z[ba]).w();if(ba>0)i.hide(z[ba]);if(ca>aa)aa=ca;}if(aa>y){i.hide(u);return;}this.$LitestandTagSuggestContainer5=[];this.$LitestandTagSuggestContainer6=false;v.forEach(this.registerSuggestion.bind(this));this.$LitestandTagSuggestContainer1.addSubscriptions(n.listen(this.$LitestandTagSuggestContainer2,'mouseenter',this.$LitestandTagSuggestContainer7.bind(this)),n.listen(this.$LitestandTagSuggestContainer2,'mouseleave',this.$LitestandTagSuggestContainer8.bind(this)));}t.prototype.registerSuggestion=function(u){'use strict';this.$LitestandTagSuggestContainer5.push(u);var v=u.js_instance;this.$LitestandTagSuggestContainer1.addSubscriptions(v.subscribe('remove',this.onRemove.bind(this,v)));};t.prototype.$LitestandTagSuggestContainer9=function(u){'use strict';if(!this.$LitestandTagSuggestContainer10){var v=this.$LitestandTagSuggestContainer3.children[0];this.$LitestandTagSuggestContainer11={top:parseInt(s.get(v,'top'),10)||0,left:parseInt(s.get(v,'left'),10)||0,inner_h:parseInt(s.get(v,'height'),10),inner_w:parseInt(s.get(v,'width'),10),outer_h:parseInt(s.get(this.$LitestandTagSuggestContainer3,'height'),10),outer_w:parseInt(s.get(this.$LitestandTagSuggestContainer3,'width'),10)};}var w=this.$LitestandTagSuggestContainer11,x=100*(u.top*w.inner_h/100+w.top)/w.outer_h,y=100*(u.left*w.inner_w/100+w.left)/w.outer_w,z=u.width*w.inner_w/w.outer_w,aa=u.height*w.inner_h/w.outer_h;return (p.div({className:"_5cnc hidden_elem",style:{top:x+'%',left:y+'%',width:z+'%',height:aa+'%'}}));};t.prototype.onRemove=function(u){'use strict';var v=this.$LitestandTagSuggestContainer5.shift();this.$LitestandTagSuggestContainer8();!(v.js_instance===u)?o(0):undefined;if(this.$LitestandTagSuggestContainer5.length===0){new h(this.$LitestandTagSuggestContainer2).ondone((function(){this.removeSingleSuggest(this.$LitestandTagSuggestContainer2);}).bind(this)).from('opacity',1).to('opacity',0).ease(h.ease.end).duration(500).go();this.cleanup();}else new h(u.suggest).ondone((function(){this.switchToNextSuggest(u.suggest,this.getNextFacebox().suggest);}).bind(this)).from('opacity',1).to('opacity',0).ease(h.ease.end).duration(500).go();};t.prototype.switchToNextSuggest=function(u,v){'use strict';i.show(v);new h(v).ondone(this.removeSingleSuggest.bind(this,u)).from('opacity',0).to('opacity',1).ease(h.ease.end).duration(500).go();};t.prototype.removeSingleSuggest=function(u){'use strict';l.remove(u);u.cleanup();};t.prototype.getNextFacebox=function(){'use strict';return this.$LitestandTagSuggestContainer5[0].js_instance;};t.prototype.$LitestandTagSuggestContainer7=function(){'use strict';if(!this.$LitestandTagSuggestContainer6){this.$LitestandTagSuggestContainer6=true;this.$LitestandTagSuggestContainer5.forEach((function(u,v,w){var x=this.$LitestandTagSuggestContainer9(u.position_data);l.appendContent(this.$LitestandTagSuggestContainer3,x);w[v].dom_element=x;}).bind(this));}this.$LitestandTagSuggestContainer12=this.$LitestandTagSuggestContainer5[0].dom_element;i.show(this.$LitestandTagSuggestContainer12);};t.prototype.$LitestandTagSuggestContainer8=function(){'use strict';this.$LitestandTagSuggestContainer12&&i.hide(this.$LitestandTagSuggestContainer12);this.$LitestandTagSuggestContainer12=null;};t.prototype.cleanup=function(){'use strict';this.$LitestandTagSuggestContainer1.release();};f.exports=t;},null);