/*!CK:2127019234!*//*1455313949,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["AzOi+"]); }

__d("PageCallToActionNuxTypes",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={AUTO_PROVISION:"auto_provision",NEW_CTA_TYPE:"new_cta_type",PREDICTION:"prediction",PROMOTION:"promotion"};},null);
__d('CctaBaseDataLoader',['Promise','AsyncRequest','URI'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();k.prototype.__getPromise=function(l,m){return new h(function(n,o){new i().setURI(l).setData(m).setHandler(function(p){if(p&&p.payload&&p.payload.payload){n(p.payload.payload);}else o({error:'no payload in response',description:'no payload in response',summary:'no payload in response'});}).setErrorHandler(function(p){return o({error:p.error,description:p.errorDescription,summary:p.errorSummary});}).send();});};function k(){}f.exports=k;},null);
__d("XCctaCreateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/ccta\/create\/",{});},null);
__d('CctaCreateDataLoader',['CctaBaseDataLoader','XCctaCreateController'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;'use strict';j=babelHelpers.inherits(l,h);k=j&&j.prototype;l.prototype.promiseCreateCcta=function(n){return this.__getPromise(i.getURIBuilder().getURI(),{payload_json:JSON.stringify(n)});};function l(){j.apply(this,arguments);}var m=new l();f.exports=m;},null);
__d("XCctaDeleteController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/ccta\/delete\/",{page_id:{type:"Int",required:true},ccta_id:{type:"Int",required:true}});},null);
__d('CctaDeleteDataLoader',['CctaBaseDataLoader','XCctaDeleteController'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;'use strict';j=babelHelpers.inherits(l,h);k=j&&j.prototype;l.prototype.promiseDeleteCcta=function(n,o){return this.__getPromise(i.getURIBuilder().setInt('page_id',n).setInt('ccta_id',o).getURI(),{});};function l(){j.apply(this,arguments);}var m=new l();f.exports=m;},null);
__d("XPagesInsightsPageDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pages\/insights\/page_data\/",{page_id:{type:"Int",required:true},request_payload_type:{type:"Enum",required:true,enumType:1}});},null);
__d('PagesInsightsPageDataStore',['FluxStore','PagesInsightsDataDispatcher','PagesInsightsDataPayloadTypes','PagesInsightsRequest','XPagesInsightsPageDataController'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n,o={};m=babelHelpers.inherits(p,h);n=m&&m.prototype;p.prototype.__onDispatch=function(q){'use strict';switch(q.type){case j.REQUEST_PAGE_ADMIN_SUMMARY_DATA:case j.REQUEST_PAGE_POST_REACH_DATA:if(!(q.pageID in o))this.$PagesInsightsPageDataStore1(q.pageID,q.type);break;case j.PAGE_ADMIN_SUMMARY_DATA:case j.PAGE_POST_REACH_DATA:o[q.pageID]=babelHelpers._extends({},o[q.pageID],q.data);this.__emitChange();break;}};p.prototype.$PagesInsightsPageDataStore1=function(q,r){'use strict';k.sendRequest(l.getURIBuilder().setInt('page_id',q).setEnum('request_payload_type',r).getURI());};p.prototype.getPageData=function(q){'use strict';return o[q]||{};};function p(){'use strict';m.apply(this,arguments);}f.exports=new p(i);},null);
__d('MercuryPagesChannelHandler',['ChannelConstants','MercuryActionType','MercuryChannelHandler','MercuryPayloadSource','MessagingEvent','MessagingRealtimeConstants'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;n=babelHelpers.inherits(p,j);o=n&&n.prototype;p.prototype.__markAsSeen=function(q,r){'use strict';if(this.isPayloadForCurrentInstance(r))o.__markAsSeen.call(this,q,r);};p.prototype.__updateModelsFromMercuryPayload=function(q,r){'use strict';if(this.isPayloadForCurrentInstance(r))o.__updateModelsFromMercuryPayload.call(this,q,r);};p.prototype.__handleMessagingPayload=function(q,r){'use strict';if(this.isPayloadForCurrentInstance(r)){o.__handleMessagingPayload.call(this,q,r);this.__handlePageMessagingPayload(q,r);}};p.prototype.__handlePageMessagingPayload=function(q,r){'use strict';switch(r.obj.event){case l.CHANGE_PAGE_THREAD_FLAG:this.$MercuryPagesChannelHandler1(q,r);break;case l.CREATE_PAGE_ADMIN_NOTE:this.$MercuryPagesChannelHandler2(q,r);break;}};p.prototype.getRouting=function(){'use strict';return {pages_messaging:this.__handleMessagingPayload};};p.prototype.__getMessagingPayloadType=function(){'use strict';return h.getArbiterType('pages_messaging');};p.prototype.__getMercuryPayloadType=function(){'use strict';return null;};p.prototype.__getInboxPayloadType=function(){'use strict';return null;};p.prototype.$MercuryPagesChannelHandler1=function(q,r){'use strict';var s={action_type:i.CHANGE_FLAG,action_id:null,mark_as_flag:r.obj.flagged,other_user_fbid:r.obj.other_user_fbid};this.__payloadPreprocessor.handleUpdate({actions:[s],payload_source:k.CLIENT_CHANNEL_MESSAGE});};p.prototype.$MercuryPagesChannelHandler2=function(q,r){'use strict';var s={action_type:i.CREATE_PAGE_ADMIN_NOTE,message_id:r.obj.message_id,note:r.obj.note,other_user_fbid:r.obj.other_user_fbid};this.__payloadPreprocessor.handleUpdate({actions:[s],payload_source:k.CLIENT_CHANNEL_MESSAGE});};p.prototype.isPayloadForCurrentInstance=function(q){'use strict';var r=q.obj[m.VIEWER_FBID]+'',s=o.getInstanceFBID.call(this)+'';return r===s;};p.prototype.__shouldDropMessageBecauseOfSync=function(q){'use strict';return false;};p.prototype.__shouldDropLogMessageBecauseOfSync=function(q){'use strict';return false;};function p(){'use strict';n.apply(this,arguments);}f.exports=p;},null);
__d('CctaDialogActionTypes',['AdsDispatchActionTypeUtils'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i='CCTA_DIALOG_',j={SHOW_FINISH_DIALOG:null,SCROLL_AREA:null,TOGGLE_MAIN_DIALOG:null,TOGGLE_DELETE_DIALOG:null,TOGGLE_CREATE_SUCCESS_DIALOG:null,TOGGLE_UPDATE_ALERT:null,CLICK_MAIN_DIALOG_SAVE_BUTTON:null,CLICK_DELETE_DIALOG_CONFIRM_BUTTON:null,RESET_UI:null,RESET_UI_LINK_APPS:null,TOGGLE_LINK_APPS_SWITCH:null,IPHONE_URI_TYPING:null,IPHONE_DEEP_LINK_TYPING:null,VALIDATE_IPHONE_DEEP_LINK:null,VALIDATE_ANDROID_DEEP_LINK:null,VALIDATE_ANDROID_PACKAGE_NAME:null,VALIDATE_ANDROID_URI:null,ANDROID_DEEP_LINK_TYPING:null,ANDROID_PACKAGE_NAME_TYPING:null,ANDROID_URI_TYPING:null,ANDROID_DEEPLINK_ERROR_FOCUSED:null,CLEAR_FOCUS:null,WEB_URI_TYPING:null,PHONE_ERROR_TYPING:null,PRIVACY_LINK_TYPING:null,TOGGLE_CONTACT_US_DESTINATION_TYPE_SWITCH:null,SHOW_ERROR_NOTICE:null,TEXTBOX_PAUSE_TYPING:null,EMAIL_ADDRESS_ERROR_TYPING:null},k=h.createActionTypeMap(i,j);f.exports=k;},null);
__d("XCctaCalloutActionController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pages\/custom_cta\/callout_action\/",{page_id:{type:"Int",required:true},action:{type:"String",required:true}});},null);
__d("XCctaCloseCreateDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/ccta\/cancel_create_dialog\/",{__asyncDialog:{type:"Int"}});},null);
__d('CctaDataStore',['AdsUtils','Arbiter','AsyncRequest','CctaConstants','CctaCreateDataLoader','CctaDeleteDataLoader','CctaDataActionTypes','CctaDialogActionTypes','CustomCallToActionConstants','PageCallToActionDestinationTypes','CctaAppDispatcher','FluxStore','PageCallToActionNuxTypes','XCctaCalloutActionController','XCctaCloseCreateDialogController','ads-lib-urllib','CustomCallToActionTypes'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x,y;'use strict';var z=c('CustomCallToActionTypes').CONFIGS,aa=c('CustomCallToActionTypes').TYPES,ba=c('CustomCallToActionTypes').MOBILE_ONLY_DESTINATION_TYPES,ca=c('CctaConstants').DialogVersion;x=babelHelpers.inherits(da,s);y=x&&x.prototype;function da(ea){y.constructor.call(this,ea);this.$CctaDataStore1={};this.$CctaDataStore2={};this.$CctaDataStore3=false;}da.prototype.getData=function(){return this.$CctaDataStore1;};da.prototype.isInitialized=function(ea){if(!this.$CctaDataStore3)return false;if(ea!==this.$CctaDataStore1.pageID){this.$CctaDataStore3=false;return false;}return true;};da.prototype.$CctaDataStore4=function(){var ea=this.$CctaDataStore1.eligibleCallToActionConfig[this.$CctaDataStore1.ctaType],fa=[];Object.keys(ea.destination_types).forEach(function(ia){fa.push(ea.destination_types[ia]);});if(!this.$CctaDataStore1.webDestinationType||fa.indexOf(this.$CctaDataStore1.webDestinationType)<0){this.$CctaDataStore1.webDestinationType=q.NONE;for(var ga=0;ga<fa.length;ga++){var ha=fa[ga];if(ba.indexOf(ha)<0){this.$CctaDataStore1.webDestinationType=ha;break;}}}if(!this.$CctaDataStore1.androidDestinationType||fa.indexOf(this.$CctaDataStore1.androidDestinationType)<0)this.$CctaDataStore1.androidDestinationType=this.$CctaDataStore1.webDestinationType;if(!this.$CctaDataStore1.iphoneDestinationType||fa.indexOf(this.$CctaDataStore1.iphoneDestinationType)<0)this.$CctaDataStore1.iphoneDestinationType=this.$CctaDataStore1.webDestinationType;};da.prototype.__onDispatch=function(ea){var fa=ea.action;switch(fa.type){case n.UPDATE_FROM_SERVER:this.$CctaDataStore2=h.clone(fa.payload);this.$CctaDataStore1=fa.payload;if(!this.$CctaDataStore1.ctaType){if(this.$CctaDataStore1.defaultCctaType){this.$CctaDataStore1.ctaType=this.$CctaDataStore1.defaultCctaType;}else this.$CctaDataStore1.ctaType=aa.CONTACT_US;this.$CctaDataStore4();}this.$CctaDataStore3=true;this.__emitChange();this.getDispatcher().handleViewAction({type:o.RESET_UI,payload:this.$CctaDataStore1});i.inform('PageCallToAction/forceUpdate',{page_id:this.$CctaDataStore1.pageID});break;case n.UPDATE_TO_SERVER:this.$CctaDataStore1.dialog_version=ca.SIMPLIFIED_DIALOG,this.$CctaDataStore1.source=fa.source;l.promiseCreateCcta(this.$CctaDataStore1).then((function(ha){this.getDispatcher().handleServerAction({type:n.UPDATE_FROM_SERVER,payload:ha});this.getDispatcher().handleViewAction({type:o.TOGGLE_MAIN_DIALOG});}).bind(this),(function(ha){this.getDispatcher().handleViewAction({type:o.SHOW_ERROR_NOTICE,payload:ha});}).bind(this));this.__emitChange();break;case n.DELETE_TO_SERVER:this.$CctaDataStore1.source=fa.source;m.promiseDeleteCcta(this.$CctaDataStore1.pageID,this.$CctaDataStore1.cctaID).then((function(ha){this.getDispatcher().handleServerAction({type:n.UPDATE_FROM_SERVER,payload:ha});}).bind(this),function(ha){});this.__emitChange();break;case n.CLOSE_NUX:var ga=u.getURIBuilder().setInt('page_id',this.$CctaDataStore1.pageID).setString('action',fa.payload).getURI();new j().setURI(ga).setErrorHandler(function(ha){}).send();this.__emitChange();case n.CLOSE_DIALOG:if(!this.$CctaDataStore1.cctaID)new j().setURI(v.getURIBuilder().getURI()).send();this.getDispatcher().handleViewAction({type:n.UPDATE_FROM_SERVER,payload:this.$CctaDataStore2});this.__emitChange();break;case n.UPDATE_PROMOTE:this.$CctaDataStore1.promoting=fa.payload;this.__emitChange();break;case n.CHANGE_CTA_TYPE:this.$CctaDataStore1.ctaType=fa.payload;this.$CctaDataStore4();this.__emitChange();break;case n.CHANGE_WEB_URI:this.$CctaDataStore1.webURI=w.normalize(fa.payload);this.__emitChange();break;case n.CHANGE_PHONE_NUMBER:this.$CctaDataStore1.countryPrefix=fa.payload.countryPrefix;this.$CctaDataStore1.nationalNumber=fa.payload.nationalNumber;this.__emitChange();break;case n.CHANGE_EMAIL_ADDRESS:this.$CctaDataStore1.emailAddress=fa.payload;this.__emitChange();break;case n.CHANGE_PHONE_EMAIL_PREFERENCE:this.$CctaDataStore1.phoneEmailPreference=fa.payload;this.__emitChange();break;case n.CHANGE_PRIVACY_LINK:this.$CctaDataStore1.privacyLink=w.normalize(fa.payload);this.__emitChange();break;case n.CHANGE_IPHONE_DEEP_LINK:this.$CctaDataStore1.iphoneDeepLink=fa.payload;this.__emitChange();break;case n.CHANGE_IPHONE_URI:this.$CctaDataStore1.iphoneURI=w.normalize(fa.payload);this.__emitChange();break;case n.SELECT_IPHONE_APP:if(fa.payload===q.WEBSITE||fa.payload===q.APP_DEEPLINK){this.$CctaDataStore1.iphoneDestinationType=fa.payload;}else{this.$CctaDataStore1.iphoneFBAppID=fa.payload;this.$CctaDataStore1.iphoneDestinationType=q.FACEBOOK_APP;}this.__emitChange();break;case n.TOGGLE_WEB_DESTINATION_TYPE:this.$CctaDataStore1.webDestinationType=fa.payload;this.$CctaDataStore1.androidDestinationType=this.$CctaDataStore1.webDestinationType;this.$CctaDataStore1.iphoneDestinationType=this.$CctaDataStore1.webDestinationType;this.__emitChange();break;case n.CHANGE_ANDROID_DEEP_LINK:this.$CctaDataStore1.androidDeepLink=fa.payload;this.__emitChange();break;case n.CHANGE_ANDROID_PACKAGE_NAME:this.$CctaDataStore1.androidPackageName=fa.payload;this.__emitChange();break;case n.CHANGE_ANDROID_URI:this.$CctaDataStore1.androidURI=w.normalize(fa.payload);this.__emitChange();break;case n.SELECT_ANDROID_APP:if(fa.payload===q.WEBSITE||fa.payload===q.APP_DEEPLINK){this.$CctaDataStore1.androidDestinationType=fa.payload;}else{this.$CctaDataStore1.androidFBAppID=fa.payload;this.$CctaDataStore1.androidDestinationType=q.FACEBOOK_APP;}this.__emitChange();break;case n.CHANGE_NATIVE_VIDEO:case n.CHANGE_INSTANT_REPLY_ENABLED:this.$CctaDataStore1.instantReplyState.isInstantReplyEnabled=fa.payload;this.__emitChange();break;case n.CHANGE_INSTANT_REPLY_MESSAGE:this.$CctaDataStore1.instantReplyState.replyMessage=fa.payload;this.__emitChange();break;case n.POST_VIDEO_FINISHED:this.$CctaDataStore1.nativeVideoID=fa.payload;this.__emitChange();break;default:}};f.exports=new da(r);},null);
__d('CustomCTAUtils',['fbt','AdsCallToActionTypes','AsyncRequest','CctaAppDispatcher','CctaDataStore','CctaDialogActionTypes','CctaTestIDs','CustomCTAConstants','CustomCTALogger','Image.react','PageCallToActionIcon','PageContentTabLoadingDialog','PagesEventType','React','XUISelector.react','CustomCallToActionTypes','CctaConstants'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=c('CustomCallToActionTypes').LABELS,x=c('CustomCallToActionTypes').MOBILE_ICONS,y=c('CustomCallToActionTypes').TYPES,z=c('CustomCallToActionTypes').TYPES,aa=c('CctaConstants').DialogVersion,ba=v.Option,ca={executeCallToAction:function(da,ea){if(da===z.CHARITY_DONATE){s.show();new j(ea).setFinallyHandler(function(fa){s.hide();}).send();}else window.open(ea);},getFallbackSelectorOptions:function(){var da=[];da.push(u.createElement(ba,{value:o.FALLBACK_GO_TO_WEBSITE},ca.getFallbackLabel(o.FALLBACK_GO_TO_WEBSITE)));da.push(u.createElement(ba,{value:o.FALLBACK_INSTALL_APP},ca.getFallbackLabel(o.FALLBACK_INSTALL_APP)));return da;},getCallToActionSelectorOptions:function(da){var ea=[];da.forEach(function(fa){ea.push(u.createElement(ba,{'data-testid':n.CCTA_TYPE_SELECTOR_OPTION_TESTID_PREFIX+fa,key:fa,value:fa,icon:u.createElement(q,{src:ca.getCallToActionIcon(fa)})},ca.getCallToActionLabel(fa)));});return ea;},getFallbackLabel:function(da){switch(da){case o.FALLBACK_INSTALL_APP:return h._("Install Now");case o.FALLBACK_GO_TO_WEBSITE:return h._("Go to Website");}return null;},getCallToActionLabel:function(da){return w[da];},getCallToActionMobileIcon:function(da){return x[da];},getCallToActionIcon:function(da){return r.get(da);},getTruncatedURI:function(da){if(!da||da.length<o.URI_TRUNCATE_LENGTH)return da;return da.substr(0,o.URI_TRUNCATE_LENGTH)+'...';},getAdsCallToActionType:function(da){switch(da){case y.BOOK_NOW:return i.TYPES.BOOK_TRAVEL.name;case y.OPEN_APP:return i.TYPES.USE_APP.name;case y.PLAY_NOW:return i.TYPES.PLAY_GAME.name;case y.SHOP_NOW:return i.TYPES.SHOP_NOW.name;case y.SIGN_UP:return i.TYPES.SIGN_UP.name;case y.WATCH_NOW:return i.TYPES.WATCH_VIDEO.name;default:return '';}},openCreateDialogFromCallout:function(){var da=l.getData();if(!da)return;p.log({event_type:t.CUSTOM_CTA_VIEW_CREATE,page_id:da.pageID,dialog_version:aa.SIMPLIFIED_DIALOG,source:'callout'});k.handleViewAction({type:m.TOGGLE_MAIN_DIALOG,source:'callout'});}};f.exports=ca;},null);
__d('ContextualDialogLockOnClick',['Event','LayerHideOnBlur','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=1000;function l(m){'use strict';this.$ContextualDialogLockOnClick1=m;}l.prototype.enable=function(){'use strict';this.$ContextualDialogLockOnClick2=new j();this.$ContextualDialogLockOnClick2.addSubscriptions(this.$ContextualDialogLockOnClick1.subscribe('show',this.$ContextualDialogLockOnClick3.bind(this)),this.$ContextualDialogLockOnClick1.subscribe('hide',this.$ContextualDialogLockOnClick4.bind(this)),h.listen(this.$ContextualDialogLockOnClick1.getRoot(),'click',this.$ContextualDialogLockOnClick5.bind(this)),h.listen(this.$ContextualDialogLockOnClick1.getCausalElement(),'click',this.$ContextualDialogLockOnClick6.bind(this)));};l.prototype.disable=function(){'use strict';this.$ContextualDialogLockOnClick1.unlockHover();this.$ContextualDialogLockOnClick2.release();};l.prototype.$ContextualDialogLockOnClick3=function(){'use strict';if(this.$ContextualDialogLockOnClick1.hasBehavior(i)){this.$ContextualDialogLockOnClick1.disableBehavior(i);setTimeout(this.$ContextualDialogLockOnClick1.enableBehavior.bind(this.$ContextualDialogLockOnClick1,i),k);}};l.prototype.$ContextualDialogLockOnClick4=function(){'use strict';this.$ContextualDialogLockOnClick1.unlockHover();};l.prototype.$ContextualDialogLockOnClick5=function(){'use strict';this.$ContextualDialogLockOnClick1.lockHover();};l.prototype.$ContextualDialogLockOnClick6=function(){'use strict';this.$ContextualDialogLockOnClick1.lockHover();this.$ContextualDialogLockOnClick1.show();};f.exports=l;},null);
__d('PagesManagerSpringboardResponseTimeHelper',['invariant','fbt'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={getSpringBoardFbtText:function(k,l){if(!k||!l||k===0)return null;var m=k>1?l+"s":l;switch(l){case "day":return i._({"day":"{time} day","days":"{time} days"},[i.param('time',k),i['enum'](m,{day:'day',days:'days'})]);case "hour":return i._({"hour":"{time} hour","hours":"{time} hours"},[i.param('time',k),i['enum'](m,{hour:'hour',hours:'hours'})]);case "minute":return i._({"minute":"{time} minute","minutes":"{time} minutes"},[i.param('time',k),i['enum'](m,{minute:'minute',minutes:'minutes'})]);case "second":return i._({"second":"{time} second","seconds":"{time} seconds"},[i.param('time',k),i['enum'](m,{second:'second',seconds:'seconds'})]);default:h(0);}}};f.exports=j;},null);
__d('PagesManagerSpringboardMetric.react',['ContextualDialogLockOnClick','ContextualLayerHideOnScroll','SpectrumIntegerScale','LayerFadeOnHide','LayerFadeOnShow','LayerHideOnTransition','LayerHideOnBlur','LayerHideOnEscape','LayerRemoveOnHide','Link.react','PagesManagerSpringboardResponseTimeHelper','React','ReactDOM','ReactLayeredComponentMixin','Style','UIPagelet','Vector','XUIContextualDialog.react','XUISpinner.react','XUIText.react','cx','fbt','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){if(c.__markCompiled)c.__markCompiled();var ea=s.PropTypes,fa=30*1000,ga=300,ha=1e+06,ia=500,ja=25,ka=s.createClass({displayName:'PagesManagerSpringboardMetric',mixins:[u],propTypes:{adjustFlyoutPositionOnload:ea.bool,count:ea.number.isRequired,unit:ea.oneOf(['day','hour','minute','second']),secondaryCount:ea.number,itemKey:ea.string.isRequired,flyoutWidth:ea.number,label:ea.string.isRequired,onFlyoutToggle:ea.func,pagelet:ea.object,hasFlyout:ea.bool,showFlyout:ea.bool,displayType:ea.oneOf(['number','percent','ratio','time']),href:ea.object},getDefaultProps:function(){return {hasFlyout:true,displayType:'number',unit:null};},getInitialState:function(){return {count:0};},componentDidMount:function(){this._onToggle(this.props.showFlyout);this._animateToNewCount(this.props.count);},componentWillReceiveProps:function(la){if(la.count!==this.props.count||la.secondaryCount!==this.props.secondaryCount){this._expireCache();this._animateToNewCount(la.count);}},render:function(){var la;if(this.props.displayType==='percent'){la=this._convertCountToPercentage();}else if(this.props.displayType==='ratio'){la=ca._("{numerator} of {denominator}",[ca.param('numerator',Math.round(this.state.count)),ca.param('denominator',this.props.secondaryCount)]);}else if(this.props.displayType==='time'){la=r.getSpringBoardFbtText(this.props.count,this.props.unit);}else{la=Math.round(this.state.count);if(la>=ha){la=j().tickFormat()(la);}else la=j().tooltipFormat()(la);}var ma;if(this.props.hasFlyout){ma=s.createElement(q,babelHelpers._extends({},this.props,{ref:'metric'}),s.createElement('span',{className:"_5vh0"},la),s.createElement('span',{className:"_5vh1"},this.props.label));}else ma=s.createElement(aa,{size:'medium',display:'block',ref:'metric'},s.createElement('span',{className:"_5vh0"},la),s.createElement('span',{className:"_xep"},this.props.label));return (s.createElement('li',{className:"_5vg_"},ma));},renderLayers:function(){if(!this.props.hasFlyout)return null;return {metricsFlyout:s.createElement(y,{autoFocus:true,behaviors:{ContextualDialogLockOnClick:h,ContextualLayerHideOnScroll:i,LayerFadeOnHide:k,LayerFadeOnShow:l,LayerHideOnTransition:m,LayerHideOnBlur:n,LayerHideOnEscape:o,LayerRemoveOnHide:p},contextRef:(function(){return this.refs.metric;}).bind(this),hoverContext:t.findDOMNode(this.refs.metric),hoverShowDelay:ga,onToggle:this._onToggle,position:'left',shown:this.props.showFlyout,width:this.props.flyoutWidth},s.createElement('div',{className:"_5x0l autofocus",ref:'flyout'},s.createElement('div',{className:"_5x0m"},s.createElement(z,{size:'large'}))))};},_expireCache:function(){this._cacheExpires=0;},_onToggle:function(la){if(this.props.onFlyoutToggle)this.props.onFlyoutToggle(la,this.props.itemKey);if(!this.props.hasFlyout)return;if(la){var ma=Date.now();if(ma>(this._cacheExpires||0)){this._cacheExpires=ma+fa;w.loadFromEndpoint(this.props.pagelet.name,t.findDOMNode(this.refs.flyout),this.props.pagelet.data,this.props.adjustFlyoutPositionOnload?{handler:this._onFlyoutLoad}:null);}}},_onFlyoutLoad:function(){var la=da('pagesManagerSpringboard');if(!la)return;var ma=x.getElementPosition(t.findDOMNode(this.refs.metric)),na=x.getElementPosition(la),oa=ma.y-na.y,pa=x.getElementDimensions(t.findDOMNode(this.refs.flyout)).y;if(oa<pa)v.set(t.findDOMNode(this.refs.flyout).offsetParent,'top',-oa+'px');},_animateToNewCount:function(la){var ma=ia/ja,na=la-this.state.count,oa=na/ma,pa=0,qa=setInterval((function(){if(++pa>=ma){clearInterval(qa);return this.setState({count:la});}var ra=this.state.count+oa;this.setState({count:ra});}).bind(this),ja);},_convertCountToPercentage:function(){return ca._("{percentage}\u0025",[ca.param('percentage',Math.round(this.state.count*100))]);}});f.exports=ka;},null);
__d("XPagesManagerMessagesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/{page_token}\/messages\/",{folder:{type:"String"},section:{type:"String"},subsection:{type:"String"},threadid:{type:"String"},mercurythreadid:{type:"String"},index:{type:"Int"},initialClientFilter:{type:"String"},page_token:{type:"String",required:true},business_id:{type:"Int"}});},null);
__d('PagesManagerSpringboard.react',['AdsCallToActionTypes','Arbiter','BizSiteIdentifier.brands','BoostedPagelikeConstants','BoostedActionType','CctaDataStore','CustomCTAConstants','CustomCTAUtils','d3/time/day','DOM','ge','HubbleConstants','HubbleContext','InsightsUtils','MercuryPagesChannelHandler','PagesManagerSpringboardMetric.react','PagesInsightsDataDispatcher','PagesInsightsDataPayloadTypes','PagesInsightsGating','PagesInsightsPageDataStore','React','tidyEvent','XPagesManagerMessagesController','cx','fbt','invariant','mapObject','formatDate','PagesMessagingConst'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja){if(c.__markCompiled)c.__markCompiled();var ka=ba.PropTypes,la=ja.UNANSWERED_FILTER,ma=430,na={LOCAL_AD_CALL_TO_ACTION_CLICKS:'local_ad_call_to_action_clicks',ADS_RUNNING:'ads_running',CALL_TO_ACTION:'call_to_action',PAGE_LIKES:'page_likes',POST_ENGAGEMENT:'post_engagement',POST_REACH:'post_reach',QRCODE_SCANS:'qrcode_scans',RESPONSE_RATE:'response_rate',RESPONSE_TIME:'response_time',WEBSITE_CLICKS:'website_clicks',CHECKINS:'checkins'},oa=ba.createClass({displayName:'PagesManagerSpringboard',propTypes:{context:ka.object,pageInfo:ka.object.isRequired,canSeePageLikeAds:ka.bool,canSeePageLocalAwarenessAds:ka.bool,canSeePagePostAds:ka.bool,activePageLikeAds:ka.number,activePageLocalAwarenessAds:ka.number,activeBoostedPostAds:ka.number,callToActionClicks:ka.number,callToActionPaidClicks:ka.number,localAdCallToActionClicks:ka.number,currentLocalAdCallToActionType:ka.string,canSeeMessages:ka.bool,canSeeInsights:ka.bool,canSeeLabelFans:ka.bool,canSeeWebsiteClicks:ka.bool,initialCallToActionTypes:ka.string,initalCanSeeCallToAction:ka.bool,newLikesCount:ka.number,websiteClicks:ka.number,qrId:ka.number,qrScansCount:ka.number,responseRate:ka.number,responseTime:ka.number,responseTimeUnit:ka.string,canSeeResponseRate:ka.bool.isRequired,canSeeResponseTime:ka.bool.isRequired,pageURIToken:ka.string.isRequired,canSeeLocalInsights:ka.bool},getDefaultProps:function(){return {canSeeResponseRate:false,canSeeResponseTime:false};},getInitialState:function(){var pa=ha(this.props.mostRecentTimes,function(ta){return u.pacificSecondsToUTCDate(ta);}),qa=new Date(Math.min(pa[s.PIPELINE_DAILY],pa[s.PIPELINE_WEEKLY])),ra=p.utc.offset(qa,-7),sa=aa.getPageData(this.props.pageInfo.id.toString());return babelHelpers._extends({activeFlyoutKey:null,callToActionClicks:0,callToActionPaidClicks:0,CallToActionTypes:this.props.initialCallToActionTypes,canSeeLocalAdCallToActionClicks:this.props.canSeePageLocalAwarenessAds,canSeeCallToAction:this.props.initialCanSeeCallToAction,activePageLikeAds:this.props.activePageLikeAds||0,activeBoostedPostAds:this.props.activeBoostedPostAds||0,insightSince:ra,insightUntil:qa,likesWeekly:0,postEngagementWeekly:0,postReachWeekly:0,checkinsWeekly:0},sa);},componentWillMount:function(){if(this.props.canSeeMessages){var pa=r('pages_manager_flyout_messages');if(pa)q.remove(pa);v.getForFBID(this.props.pageInfo.id).turnOn();}m.addListener((function(event){if(m.isInitialized(this.props.pageInfo.id.toString()))this.setState({canSeeCallToAction:!!m.getData().cctaID,CallToActionTypes:m.getData().ctaType});}).bind(this));aa.addListener((function(){var qa=aa.getPageData(this.props.pageInfo.id);this.setState({checkinsWeekly:qa.checkinsWeekly||this.state.checkinsWeekly,likesWeekly:qa.likesWeekly||this.state.likesWeekly,postEngagementWeekly:qa.postEngagementWeekly||this.state.postEngagementWeekly,postReachWeekly:qa.postReachWeekly||this.state.postReachWeekly});}).bind(this));},componentDidMount:function(){t.setContext(this.props.context);if(this.props.canSeeInsights)x.dispatch({pageID:this.props.pageInfo.id,type:y.REQUEST_PAGE_ADMIN_SUMMARY_DATA});if(this.props.canSeePageLikeAds)ca(i.subscribe(k.PANEL_STATUS_CHANGE_FINISH,(function(pa,qa){var ra=qa.active?1:0;if(this.state.activePageLikeAds!==ra&&qa.action_type===l.PAGELIKE)this.setState({activeFlyoutKey:na.PAGE_LIKES,activePageLikeAds:ra});}).bind(this)));ca(i.subscribe(n.SHOW_FLYOUT,(function(pa,qa){this.setState({activeFlyoutKey:na.CALL_TO_ACTION});}).bind(this)));},render:function(){var pa=[];pa.push(this._renderAds());if(!z.hasAdminSummaryLikesRemoveTest)pa.push(this._renderNewLikes());pa.push(this._renderPostReach());if(z.hasAdminSummaryLikesRemoveTest)pa.push(this._renderPostEngagement());pa.push(this._renderQRScans());pa.push(this._renderCallToAction());pa.push(this._renderWebsiteClicks());pa.push(this._renderLocalAdCallToActionClicks());pa.push(this._renderResponseRate());pa.push(this._renderResponseTime());pa.push(this._renderCheckins());var qa=false;for(var ra=0;ra<pa.length;ra++)if(pa[ra]!==null){qa=true;break;}if(!qa)return null;pa.unshift(ba.createElement('div',{key:'title',className:"_5vg-"},ba.createElement('h4',null,fa._("This week"))));return (ba.createElement('div',{className:"_5vgz",id:'pagesManagerSpringboard'},pa));},_renderAds:function(){if(!this.props.showAdsRunning||!this.props.canSeePageLikeAds&&!this.props.canSeePagePostAds)return null;var pa=(this.props.canSeePageLikeAds?this.state.activePageLikeAds:0)+(this.props.canSeePagePostAds?this.state.activeBoostedPostAds:0);return (ba.createElement('ul',{key:'ads'},ba.createElement(w,{itemKey:na.ADS_RUNNING,showFlyout:this.state.activeFlyoutKey===na.ADS_RUNNING,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardActiveAdsPagelet',data:{page_id:this.props.pageInfo.id,page_like_eligible:this.props.canSeePageLikeAds,page_post_eligible:this.props.canSeePagePostAds,active_boosted_post_ads:this.state.activeBoostedPostAds}},flyoutWidth:290,count:pa,label:fa._({"Ad":"Ad Running","Ads":"Ads Running"},[fa['enum'](this.state.activeAdCount===1?'Ad':'Ads',{Ad:'Ad',Ads:'Ads'})])})));},_renderNewLikes:function(){var pa=this.props.pageInfo,qa=this.props.canSeeLabelFans?372:290,ra=p.utc.offset(this.state.insightUntil,-1),sa=0;if(this.props.canSeeInsights){sa=this.state.likesWeekly;}else sa=this.props.newLikesCount;return (ba.createElement('ul',{key:'new_likes'},ba.createElement(w,{itemKey:na.PAGE_LIKES,showFlyout:this.state.activeFlyoutKey===na.PAGE_LIKES,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardNewLikesPagelet',data:{page_id:pa.id,count:sa,width:qa,since:ia(this.state.insightSince,'m/d/Y',{utc:true}),until:ia(ra,'m/d/Y',{utc:true}),since_timestamp:u.dateToSeconds(this.state.insightSince)}},flyoutWidth:qa,count:sa,label:fa._({"Like":"Page Like","Likes":"Page Likes"},[fa['enum'](this.state.likesWeekly===1?'Like':'Likes',{Like:'Like',Likes:'Likes'})])})));},_renderWebsiteClicks:function(){if(!this.props.canSeeWebsiteClicks)return null;return (ba.createElement('ul',{key:'website_clicks'},ba.createElement(w,{count:this.props.websiteClicks,flyoutWidth:328,itemKey:na.WEBSITE_CLICKS,label:fa._({"Click":"Website Click","Clicks":"Website Clicks"},[fa['enum'](this.props.websiteClicks===1?'Click':'Clicks',{Click:'Click',Clicks:'Clicks'})]),onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardWebsiteClicksPagelet',data:{page_id:this.props.pageInfo.id}},showFlyout:this.state.activeFlyoutKey===na.WEBSITE_CLICKS})));},_renderPostReach:function(){if(!this.props.canSeeInsights)return null;var pa=this.props.pageInfo,qa=p.utc.offset(this.state.insightUntil,-1);return (ba.createElement('ul',{key:'post_reach'},ba.createElement(w,{itemKey:na.POST_REACH,showFlyout:this.state.activeFlyoutKey===na.POST_REACH,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardPostReachPagelet',data:{page_id:pa.id,context:this.props.context,since:ia(this.state.insightSince,'m/d/Y',{utc:true}),until:ia(qa,'m/d/Y',{utc:true})}},flyoutWidth:624,count:this.state.postReachWeekly,label:fa._("Post Reach")})));},_renderPostEngagement:function(){if(!this.props.canSeeInsights)return null;var pa=this.props.pageInfo,qa=p.utc.offset(this.state.insightUntil,-1);return (ba.createElement('ul',{key:'post_engagement'},ba.createElement(w,{itemKey:na.POST_ENGAGEMENT,showFlyout:this.state.activeFlyoutKey===na.POST_ENGAGEMENT,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardPostEngagementPagelet',data:{page_id:pa.id,context:this.props.context,since:ia(this.state.insightSince,'m/d/Y',{utc:true}),until:ia(qa,'m/d/Y',{utc:true})}},flyoutWidth:624,count:this.state.postEngagementWeekly,label:fa._("Post Engagement")})));},_renderQRScans:function(){if(!this.props.hasValidQRCode)return null;var pa=this.props.qrScansCount,qa=430,ra=p.utc.offset(this.state.insightUntil,-1);return (ba.createElement('ul',{key:'qr_scans'},ba.createElement(w,{itemKey:na.QRCODE_SCANS,showFlyout:this.state.activeFlyoutKey===na.QRCODE_SCANS,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardQRScansPagelet',data:{page_id:this.props.pageInfo.id,qr_id:this.props.qrId,since:ia(this.state.insightSince,'m/d/Y',{utc:true}),since_timestamp:u.dateToSeconds(this.state.insightSince),until:ia(ra,'m/d/Y',{utc:true})}},flyoutWidth:qa,count:pa,label:fa._({"Scan":"QRCode Scan","Scans":"QRCode Scans"},[fa['enum'](pa===1?'Scan':'Scans',{Scan:'Scan',Scans:'Scans'})])})));},_renderCallToAction:function(){if(!this.state.canSeeCallToAction)return null;return (ba.createElement('ul',{key:'cta'},ba.createElement(w,{ref:'ctaSpringBoard',itemKey:na.CALL_TO_ACTION,showFlyout:this.state.activeFlyoutKey===na.CALL_TO_ACTION,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardCallToActionPagelet',data:{page_id:this.props.pageInfo.id}},count:this.props.callToActionClicks+this.props.callToActionPaidClicks,flyoutWidth:328,label:o.getCallToActionLabel(this.state.CallToActionTypes)})));},_renderLocalAdCallToActionClicks:function(){if(!this.state.canSeeLocalAdCallToActionClicks||!this.props.currentLocalAdCallToActionType)return null;var pa=this._getCTAClicksCounterLabel(this.props.currentLocalAdCallToActionType);return (ba.createElement('ul',{key:'ads_cta'},ba.createElement(w,{itemKey:na.LOCAL_AD_CALL_TO_ACTION_CLICKS,showFlyout:this.state.activeFlyoutKey===na.LOCAL_AD_CALL_TO_ACTION_CLICKS,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardLocalAdCallToActionClicksPagelet',data:{page_id:this.props.pageInfo.id}},count:this.props.localAdCallToActionClicks,flyoutWidth:328,label:pa})));},_getCTAClicksCounterLabel:function(pa){var qa=h.TYPES[pa];!qa?ga(0):undefined;var ra;switch(qa){case h.TYPES.MESSAGE_PAGE:ra=fa._("Send Message Clicks");break;default:ra=qa.text;break;}return ra;},_renderResponseRate:function(){if(!this.props.canSeeResponseRate||this.props.responseRate===null)return null;var pa=this.props.showRatio?Math.min(this.props.numConversations,this.props.numThreads):this.props.responseRate,qa=fa._("Response Rate");return this._renderResponseComponent(na.RESPONSE_RATE,this.props.showRatio?'ratio':'percent',pa,null,this.props.numThreads,qa);},_renderResponseTime:function(){if(!this.props.canSeeResponseTime||this.props.responseTime===null||this.props.responseTimeUnit===null)return null;var pa=fa._("Response Time");return this._renderResponseComponent(na.RESPONSE_TIME,'time',this.props.responseTime,this.props.responseTimeUnit,null,pa);},_renderResponseComponent:function(pa,qa,ra,sa,ta,ua){var va=da.getURIBuilder().setString('page_token',this.props.pageURIToken).setString('initialClientFilter',la).getURI();return (ba.createElement('ul',{key:pa},ba.createElement(w,{itemKey:pa,showFlyout:this.state.activeFlyoutKey===pa,onFlyoutToggle:this._onFlyoutToggle,adjustFlyoutPositionOnload:true,pagelet:{name:'PagesManagerSpringboardMessagesPagelet',data:{business_id:j.getBusinessID(),page_id:this.props.pageInfo.id,initialClientFilter:la}},displayType:qa,flyoutWidth:ma,count:ra,unit:sa,secondaryCount:ta,label:ua,href:va})));},_renderCheckins:function(){if(!this.props.canSeeInsights||!this.props.canSeeLocalInsights)return null;return (ba.createElement('ul',{key:'checkins'},ba.createElement(w,{itemKey:na.CHECKINS,showFlyout:false,pagelet:{name:'PagesManagerSpringboardCheckinsPagelet'},count:this.state.checkinsWeekly,label:fa._("Check-ins")})));},_onFlyoutToggle:function(pa,qa){if(pa){this.setState({activeFlyoutKey:qa});}else if(this.state.activeFlyoutKey===qa)this.setState({activeFlyoutKey:null});}});f.exports=oa;},null);