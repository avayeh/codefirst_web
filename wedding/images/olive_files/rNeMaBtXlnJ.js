/*!CK:3835447797!*//*1455520315,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["0ILtx"]); }

__d("ChatNotificationConstants",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={NORMAL:0,NO_USER_MESSAGE_NOTIFICATION:1};},null);
__d("MessagingEvent",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={DELETE:"delete",DELETE_MESSAGES:"delete_messages",DELIVER:"deliver",ERROR:"error",READ:"read",REPORT_SPAM:"report_spam",REPORT_SPAM_MESSAGES:"report_spam_messages",UNMARK_SPAM:"unmark_spam",SUBSCRIBE:"subscribe",CHANGE_MUTE_SETTINGS:"change_mute_settings",TAG:"tag",UNREAD:"unread",UNSUBSCRIBE:"unsubscribe",DELIVER_LOG:"deliver_log",MORE_THREADS:"more_threads",READ_ALL:"read_all",READ_RECEIPT:"read_receipt",DELIVERY_RECEIPT:"delivery_receipt",SENT_PUSH:"sent_push",DELIVER_FAST_PAST:"deliver_fast_path",MESSENGER_STATUS:"messenger_status",UPDATE_PINNED_THREADS:"update_pinned_threads",CHANGE_PAGE_THREAD_FLAG:"change_page_thread_flag",UPDATE_BLOCKER_STATUS:"update_blocker_status",UPDATE_BLOCKEE_STATUS:"update_blockee_status",CREATE_PAGE_ADMIN_NOTE:"create_page_admin_note",NO_OP:"no_op"};},null);
__d('TreeMap',['Map','nullthrows'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();function j(x,y,z){this.key=x;this.value=y;this.time=z;}function k(x){this.$TreeMap1=function(y,z){var aa=x(y,z);return aa!==0?aa:y.time-z.time;};this.$TreeMap2=new h();this.$TreeMap3=null;this.$TreeMap4=0;this.size=this.$TreeMap2.size;}k.prototype.clear=function(){this.$TreeMap2=new h();this.$TreeMap3=null;this.size=this.$TreeMap2.size;};k.prototype.has=function(x){return this.$TreeMap2.has(x);};k.prototype.set=function(x,y){if(this.has(x))this['delete'](x);var z=new j(x,y,this.$TreeMap4++);this.$TreeMap2.set(x,z);this.$TreeMap3=r(this.$TreeMap3,z,this.$TreeMap1);this.size=this.$TreeMap2.size;return this;};k.prototype.get=function(x){return this.has(x)?this.$TreeMap2.get(x).value:undefined;};k.prototype['delete']=function(x){if(!this.has(x))return false;var y=this.$TreeMap2.get(x);this.$TreeMap3=s(this.$TreeMap3,y,this.$TreeMap1);this.$TreeMap2['delete'](x);this.size=this.$TreeMap2.size;return true;};k.prototype.keys=function(){var x=[];w(this.$TreeMap3,x,function(y){return y.key;});return x;};k.prototype.values=function(){var x=[];w(this.$TreeMap3,x,function(y){return y.value;});return x;};k.prototype.entries=function(){var x=[];w(this.$TreeMap3,x,function(y){return {key:y.key,value:y.value};});return x;};k.prototype.range=function(x,y){var z=[],aa=null;if(x)aa=new j(x.key,x.value,-1);var ba=null;if(y)ba=new j(y.key,y.value,this.$TreeMap4);w(this.$TreeMap3,z,function(ca){return {key:ca.key,value:ca.value};},this.$TreeMap1,aa,ba);return z;};k.prototype.min=function(){if(!this.$TreeMap3)return undefined;var x=t(i(this.$TreeMap3)),y=x.key,z=x.value;return {key:y,value:z};};k.prototype.max=function(){if(!this.$TreeMap3)return undefined;var x=u(i(this.$TreeMap3)),y=x.key,z=x.value;return {key:y,value:z};};k.prototype.__testRoot=function(){};function l(x){if(!x)return x;q(x);if(x.balanceFactor<-1){if(x.right&&x.right.balanceFactor<=0){return m(x);}else return n(x);}else if(x.balanceFactor>1){if(x.left&&x.left.balanceFactor>=0){return o(x);}else return p(x);}else return x;}function m(x){var y=x,z=i(y.right),aa=z.left;y.right=aa;q(y);i(z).left=y;q(z);return z;}function n(x){var y=x,z=i(y.right),aa=i(z.left),ba=aa.left,ca=aa.right;y.right=ba;q(y);z.left=ca;q(z);aa=i(aa);aa.left=y;aa.right=z;q(aa);return aa;}function o(x){var y=x,z=i(y.left),aa=z.right;y.left=aa;q(y);z.right=y;q(z);return z;}function p(x){var y=x,z=i(y.left),aa=i(z.right),ba=aa.left,ca=aa.right;z.right=ba;q(z);y.left=ca;q(y);aa.left=z;aa.right=y;q(aa);return aa;}function q(x){var y=x.left?x.left.height:-1,z=x.right?x.right.height:-1;x.height=Math.max(y,z)+1;x.balanceFactor=y-z;}function r(x,y,z){if(x==null)return l(y);var aa=z(y,x);if(aa<0){x.left=r(x.left,y,z);return l(x);}else{x.right=r(x.right,y,z);return l(x);}}function s(x,y,z){if(x==null)return null;if(x===y)if(x.left&&x.right){var aa=u(x.left);x.left=v(x.left);aa.left=x.left;aa.right=x.right;return l(aa);}else if(x.left){return l(x.left);}else if(x.right){return l(x.right);}else return null;var ba=z(y,x);if(ba<0){x.left=s(x.left,y,z);return l(x);}else{x.right=s(x.right,y,z);return l(x);}}function t(x){while(x.left)x=x.left;return x;}function u(x){while(x.right)x=x.right;return x;}function v(x){if(!x)return null;if(x.right==null)return l(x.left||null);x.right=v(x.right);return l(x);}function w(x,y,z,aa,ba,ca){if(x==null)return;var da=!aa||!ba||aa(x,ba)>=0,ea=!aa||!ca||aa(x,ca)<=0;if(da)w(x.left,y,z,aa,ba,ca);if(da&&ea)y.push(z(x));if(ea)w(x.right,y,z,aa,ba,ca);}f.exports=k;},null);
__d('Cache',['DateConsts','Map','TreeMap'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();function k(){this.$Cache1=new i();}k.prototype.has=function(l){return this.$Cache1.has(l);};k.prototype.get=function(l,m){var n=this.__getRaw(l);if(!n)return m;return n.$Cache2;};k.prototype.getAll=function(l,m){var n=new i();l.forEach((function(o){return n.set(o,this.get(o,m));}).bind(this));return n;};k.prototype['delete']=function(l){var m=this.__getRaw(l);if(m&&m.$Cache3)clearTimeout(m.$Cache3);return this.$Cache1['delete'](l);};k.prototype.clear=function(){this.$Cache1.forEach(function(l){if(l&&l.$Cache3)clearTimeout(l.$Cache3);});this.$Cache1.clear();};k.prototype.set=function(l,m,n,o){if(!this.shouldUpdate(l,n))return false;var p=this.__getRaw(l);if(!p)p=this.__getNewRawObject();delete p.$Cache2;delete p.$Cache4;if(p.$Cache3)clearTimeout(p.$Cache3);delete p.$Cache3;p.$Cache2=m;if(n!=null)p.$Cache4=n;if(o!=null&&o>=0)p.$Cache3=setTimeout(this['delete'].bind(this,l),o*h.MS_PER_SEC*h.SEC_PER_MIN);this.__setRaw(l,p);return true;};k.prototype.shouldUpdate=function(l,m){var n=this.__getRaw(l);return (n==null||n.$Cache4==null||m==null||m>n.$Cache4);};k.prototype.size=function(){return this.$Cache1.size;};k.prototype.__getRaw=function(l){return this.$Cache1.get(l);};k.prototype.__setRaw=function(l,m){this.$Cache1.set(l,m);};k.prototype.__getNewRawObject=function(){return {$Cache2:null,$Cache3:null,$Cache4:null,$Cache5:null,$Cache6:null};};k.prototype.__keys=function(){return this.$Cache1.keys();};f.exports=k;},null);
__d('ChatQuietLinks',['DataStore','DOM','Event','Parent','UserAgent_DEPRECATED','getOrCreateDOMID'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={},o={silenceLinks:function(s){p(s,this.removeEmptyHrefs.bind(this));},nukeLinks:function(s){p(s,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(s){q(s,function(t){return !t||t==='#';});},removeAllHrefs:function(s){q(s);}};function p(s,t){var u=!!l.chrome(),v=!!l.chrome()||l.ie()>=9||l.firefox()>=4;if(n[m(s)])return;n[m(s)]=true;if(!v)return;if(!u){t&&t(s);return;}j.listen(s,'mouseover',function w(x){var y=k.byTag(x.getTarget(),'a');if(y){var z=y.getAttribute('href');if(r(z)){h.set(y,'stashedHref',y.getAttribute('href'));y.removeAttribute('href');}}});j.listen(s,'mouseout',function w(x){var y=k.byTag(x.getTarget(),'a'),z=y&&h.remove(y,'stashedHref');if(r(z))y.setAttribute('href',z);});j.listen(s,'mousedown',function(w){if(!w.isDefaultRequested())return true;var x=k.byTag(w.getTarget(),'a'),y=x&&h.get(x,'stashedHref');if(r(y))x.setAttribute('href',y);});}function q(s,t){var u=i.scry(s,'a');if(t)u=u.filter(function(v){return t(v.getAttribute('href'));});u.forEach(function(v){v.removeAttribute('href');if(!v.tabIndex)v.setAttribute('tabindex',0);});}function r(s){return s&&s!=='#';}f.exports=o;},null);
__d('ExplicitRegistrationDispatcherUtils',['ErrorUtils','FluxInternalConfig','emptyFunction','monitorCodeUse','setImmediate'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=j,n=false,o=j;f.exports={guessStoreName:m,warn:o,inlineRequiresEnabled:n};},null);
__d('ExplicitRegistrationDispatcher',['Dispatcher_DEPRECATED','ExplicitRegistrationDispatcherUtils','setImmediate'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;'use strict';k=babelHelpers.inherits(m,h);l=k&&k.prototype;function m(n){var o=n.strict;return (function(){l.constructor.call(this);this.$ExplicitRegistrationDispatcher1=o;this.$ExplicitRegistrationDispatcher2=1;this.$ExplicitRegistrationDispatcher3={};this.$ExplicitRegistrationDispatcher4={};this.$ExplicitRegistrationDispatcher5={};}).apply(this,arguments);}m.prototype.explicitlyRegisterStore=function(n){var o=n.getDispatchToken(),p=this.$ExplicitRegistrationDispatcher4[o];this.$ExplicitRegistrationDispatcher5[p]=true;};m.prototype.explicitlyRegisterStores=function(n){n.forEach((function(o){return this.explicitlyRegisterStore(o);}).bind(this));};m.prototype.register=function(n){var o=this.$ExplicitRegistrationDispatcher2++;this.$ExplicitRegistrationDispatcher3[o]=n;this.$ExplicitRegistrationDispatcher5[o]=false;var p=l.register.call(this,this.$ExplicitRegistrationDispatcher7.bind(this,o));this.$ExplicitRegistrationDispatcher4[p]=o;return p;};m.prototype.$ExplicitRegistrationDispatcher7=function(n,o){if(this.$ExplicitRegistrationDispatcher5[n]||!this.$ExplicitRegistrationDispatcher1)this.$ExplicitRegistrationDispatcher3[n](o);};f.exports=m;},null);
__d('ChatDispatcher',['ExplicitRegistrationDispatcher','LogHistory'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;'use strict';var l=i.getInstance('chat_dispatcher');j=babelHelpers.inherits(m,h);k=j&&j.prototype;m.prototype.dispatch=function(n){l.debug('action',n.type);k.dispatch.call(this,n);};function m(){j.apply(this,arguments);}f.exports=new m({strict:false});},null);
__d('ChatTabActions',['ChatDispatcher','keyMirror'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=i({CLOSE_TAB:null,CLOSE_ALL_TABS:null,CLOSE_FRAGILE_TABS:null,LOWER_TAB:null,OPEN_FRAGILE_TAB:null,OPEN_TAB:null,PERSIST_LOCAL_STATE:null,PROMOTE_TAB:null,RAISE_TAB:null}),k={Types:j,closeTab:function(l,m){h.dispatch({actionType:j.CLOSE_TAB,reason:m,threadID:l});},closeAllTabs:function(){h.dispatch({actionType:j.CLOSE_ALL_TABS});},closeFragileTabs:function(){h.dispatch({actionType:j.CLOSE_FRAGILE_TABS});},lowerTab:function(l){h.dispatch({actionType:j.LOWER_TAB,threadID:l});},openFragileTab:function(l){h.dispatch({actionType:j.OPEN_FRAGILE_TAB,threadID:l});},openTab:function(l){h.dispatch({actionType:j.OPEN_TAB,threadID:l});},persistLocalState:function(){h.dispatch({actionType:j.PERSIST_LOCAL_STATE});},promoteTab:function(l){h.dispatch({actionType:j.PROMOTE_TAB,threadID:l});},raiseTab:function(l,m,n){h.dispatch({actionType:j.RAISE_TAB,signatureID:n,threadID:l,userAction:m});}};f.exports=k;},null);
__d('md5',['str2rstr'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(v,w){var x=v[0],y=v[1],z=v[2],aa=v[3];x=k(x,y,z,aa,w[0],7,-680876936);aa=k(aa,x,y,z,w[1],12,-389564586);z=k(z,aa,x,y,w[2],17,606105819);y=k(y,z,aa,x,w[3],22,-1044525330);x=k(x,y,z,aa,w[4],7,-176418897);aa=k(aa,x,y,z,w[5],12,1200080426);z=k(z,aa,x,y,w[6],17,-1473231341);y=k(y,z,aa,x,w[7],22,-45705983);x=k(x,y,z,aa,w[8],7,1770035416);aa=k(aa,x,y,z,w[9],12,-1958414417);z=k(z,aa,x,y,w[10],17,-42063);y=k(y,z,aa,x,w[11],22,-1990404162);x=k(x,y,z,aa,w[12],7,1804603682);aa=k(aa,x,y,z,w[13],12,-40341101);z=k(z,aa,x,y,w[14],17,-1502002290);y=k(y,z,aa,x,w[15],22,1236535329);x=l(x,y,z,aa,w[1],5,-165796510);aa=l(aa,x,y,z,w[6],9,-1069501632);z=l(z,aa,x,y,w[11],14,643717713);y=l(y,z,aa,x,w[0],20,-373897302);x=l(x,y,z,aa,w[5],5,-701558691);aa=l(aa,x,y,z,w[10],9,38016083);z=l(z,aa,x,y,w[15],14,-660478335);y=l(y,z,aa,x,w[4],20,-405537848);x=l(x,y,z,aa,w[9],5,568446438);aa=l(aa,x,y,z,w[14],9,-1019803690);z=l(z,aa,x,y,w[3],14,-187363961);y=l(y,z,aa,x,w[8],20,1163531501);x=l(x,y,z,aa,w[13],5,-1444681467);aa=l(aa,x,y,z,w[2],9,-51403784);z=l(z,aa,x,y,w[7],14,1735328473);y=l(y,z,aa,x,w[12],20,-1926607734);x=m(x,y,z,aa,w[5],4,-378558);aa=m(aa,x,y,z,w[8],11,-2022574463);z=m(z,aa,x,y,w[11],16,1839030562);y=m(y,z,aa,x,w[14],23,-35309556);x=m(x,y,z,aa,w[1],4,-1530992060);aa=m(aa,x,y,z,w[4],11,1272893353);z=m(z,aa,x,y,w[7],16,-155497632);y=m(y,z,aa,x,w[10],23,-1094730640);x=m(x,y,z,aa,w[13],4,681279174);aa=m(aa,x,y,z,w[0],11,-358537222);z=m(z,aa,x,y,w[3],16,-722521979);y=m(y,z,aa,x,w[6],23,76029189);x=m(x,y,z,aa,w[9],4,-640364487);aa=m(aa,x,y,z,w[12],11,-421815835);z=m(z,aa,x,y,w[15],16,530742520);y=m(y,z,aa,x,w[2],23,-995338651);x=n(x,y,z,aa,w[0],6,-198630844);aa=n(aa,x,y,z,w[7],10,1126891415);z=n(z,aa,x,y,w[14],15,-1416354905);y=n(y,z,aa,x,w[5],21,-57434055);x=n(x,y,z,aa,w[12],6,1700485571);aa=n(aa,x,y,z,w[3],10,-1894986606);z=n(z,aa,x,y,w[10],15,-1051523);y=n(y,z,aa,x,w[1],21,-2054922799);x=n(x,y,z,aa,w[8],6,1873313359);aa=n(aa,x,y,z,w[15],10,-30611744);z=n(z,aa,x,y,w[6],15,-1560198380);y=n(y,z,aa,x,w[13],21,1309151649);x=n(x,y,z,aa,w[4],6,-145523070);aa=n(aa,x,y,z,w[11],10,-1120210379);z=n(z,aa,x,y,w[2],15,718787259);y=n(y,z,aa,x,w[9],21,-343485551);v[0]=t(x,v[0]);v[1]=t(y,v[1]);v[2]=t(z,v[2]);v[3]=t(aa,v[3]);}function j(v,w,x,y,z,aa){w=t(t(w,v),t(y,aa));return t(w<<z|w>>>32-z,x);}function k(v,w,x,y,z,aa,ba){return j(w&x|~w&y,v,w,z,aa,ba);}function l(v,w,x,y,z,aa,ba){return j(w&y|x&~y,v,w,z,aa,ba);}function m(v,w,x,y,z,aa,ba){return j(w^x^y,v,w,z,aa,ba);}function n(v,w,x,y,z,aa,ba){return j(x^(w|~y),v,w,z,aa,ba);}function o(v){var w=v.length,x=[1732584193,-271733879,-1732584194,271733878],y;for(y=64;y<=v.length;y+=64)i(x,p(v.substring(y-64,y)));v=v.substring(y-64);var z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(y=0;y<v.length;y++)z[y>>2]|=v.charCodeAt(y)<<((y&3)<<3);z[y>>2]|=128<<((y&3)<<3);if(y>55){i(x,z);for(y=0;y<16;y++)z[y]=0;}z[14]=w*8;i(x,z);return x;}function p(v){var w=[],x=0;while(x<64)w[x>>2]=v.charCodeAt(x++)|v.charCodeAt(x++)<<8|v.charCodeAt(x++)<<16|v.charCodeAt(x++)<<24;return w;}var q='0123456789abcdef'.split('');function r(v){var w='',x=0;for(;x<4;x++)w+=q[v>>(x<<3)+4&15]+q[v>>(x<<3)&15];return w;}function s(v){for(var w=0;w<v.length;w++)v[w]=r(v[w]);return v.join('');}var t=function(v,w){return v+w&4294967295;};function u(v){if(null===v||undefined===v){return null;}else{for(var w=0;w<v.length;w++)if(v[w]>"\u007F"){v=h(v);break;}return s(o(v));}}if(u('hello')!='5d41402abc4b2a76b9719d911017c592')t=function(v,w){var x=(v&65535)+(w&65535),y=(v>>16)+(w>>16)+(x>>16);return y<<16|x&65535;};f.exports=u;},null);
__d('WebMessengerEvents',['Arbiter'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=Object.assign(new h(),{MASTER_DOM_CHANGED:'master-dom-changed',DETAIL_DOM_CHANGED:'detail-dom-changed',FOCUS_COMPOSER:'focus-composer',FOCUS_SEARCH:'focus-search',FOCUS_AND_SELECT_SEARCH:'focus-and-select-search',STICKER_CLICKED:'sticker-clicked',SUBMIT_REPLY:'submit-reply',UPDATE_SELECTION:'update-selection',masterDOMChanged:function(){this.inform(i.MASTER_DOM_CHANGED);},detailDOMChanged:function(){this.inform(i.DETAIL_DOM_CHANGED);},focusComposer:function(){this.inform(i.FOCUS_COMPOSER);},focusSearch:function(){this.inform(i.FOCUS_SEARCH);},focusAndSelectSearch:function(){this.inform(i.FOCUS_AND_SELECT_SEARCH);},updateSelection:function(j){this.inform(i.UPDATE_SELECTION,j);},stickerClicked:function(j,k){this.inform(i.STICKER_CLICKED,{packID:j,stickerID:k});},submitReply:function(){this.inform(i.SUBMIT_REPLY);}});f.exports=i;},null);
__d('WebMessengerSubscriptionsHandler',['SubscriptionsHandler'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=new h('webmessenger');f.exports=i;},null);
__d("isWebMessengerURI",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){return (/^(\/messages)/.test(i.getPath()));}f.exports=h;},null);
__d('WebMessengerWidthControl',['$','Arbiter','BlueBar','CSS','CSSClassTransition','Event','Style','URI','ViewportBounds','WebMessengerEvents','WebMessengerSubscriptionsHandler','cx','getViewportDimensions','isWebMessengerURI','requestAnimationFrame','setTimeoutAcrossTransitions','shield','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();var z=205,aa=981,ba=257,ca=18,da=848,ea=724,fa=.57,ga=56,ha,ia,ja;function ka(pa,qa,ra){this.masterChanged=pa;this.detailChaned=qa;r.addSubscriptions(m.listen(window,'resize',y(x(la,this,this),100)),i.subscribe(['sidebar/initialized','sidebar/show','sidebar/hide','minisidebar/show'],x(la,this,this),i.SUBSCRIBE_NEW));var sa=oa()?ga:0;if(ra)sa=z;this._width=oa()?0:da;ja=true;la(this,sa);}function la(pa,qa){var ra=p.getRight()+p.getLeft();ra=ra||qa||0;var sa=t.withoutScrollbars().width-ra,ta=Math.round(Math.max(0,sa/2-aa/2));sa=aa+ta-ba;sa-=ca;sa=Math.max(ea,Math.min(da,sa));if(!isNaN(sa)&&pa._width!==sa){pa._width=sa;var ua=Math.round(sa/(1+fa)),va=sa-ua;pa.masterChanged(va);pa.detailChaned(ua);if(oa()){var wa=sa+ba;ma(function(){if(ia){document.body.className=ia;ia='';}na(wa+'px');k.removeClass(document.body,"_5uj5");ja&&q.detailDOMChanged();ja=false;},ia);}}}function ma(pa,qa){qa&&k.addClass(document.documentElement,"_5uj6");v(pa);qa&&w(k.removeClass.bind(null,document.documentElement,"_5uj6"),1000);}function na(pa){n.set(j.getNavRoot(),'width',pa);n.set(h('globalContainer'),'width',pa);}function oa(){if(!ha)ha=k.hasClass(document.body,"_6nw");return ha;}l.registerHandler(function(pa,qa,ra,sa){function ta(ua){return oa()&&u(new o(ua));}if(ta(sa)){ia=qa;return true;}else if(ta(ra)){ma(function(){pa.className=qa;na('');},true);return true;}});f.exports=ka;},null);
__d('Dock',['Event','shield','Arbiter','ArbiterMixin','BlueBar','ChatQuietLinks','CSS','DataStore','DOM','Parent','Scroll','Style','Toggler','Vector','csx','emptyFunction','WebMessengerWidthControl'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();c('WebMessengerWidthControl');function x(){}Object.assign(x,k,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(y){this.init=w;this.rootEl=y;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();m.removeEmptyHrefs(this.rootEl);h.listen(y,'click',this._onClick.bind(this));h.listen(window,'resize',this._onWindowResize.bind(this));t.subscribe(['show','hide'],(function(z,aa){var ba=aa.getActive();if(!p.contains(y,ba))return;if(n.hasClass(ba,'fbNub')){this.notifyNub(ba,z);if(z==='show')this._resizeNubFlyout(ba);}else{var ca=q.byClass(ba,'fbNubFlyout');if(ca)n.conditionClass(ca,'menuOpened',z==='show');}}).bind(this));this.inform('init',{},j.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return this.viewportDimensions=u.getViewportDimensions();},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+u.getElementDimensions(this.rootEl).y;var y=l.getBar();if(y){var z=s.isFixed(y)?'viewport':'document';this.flyoutHeightOffset+=u.getElementPosition(y,z).y+u.getElementDimensions(y).y;}},toggle:function(y){var z=this._findFlyout(y);if(!z)return;this.subscribe('init',function(){t.toggle(y);});},show:function(y){this.subscribe('init',function(){t.show(y);});},showNub:function(y){n.show(y);},hide:function(y){this.subscribe('init',function(){var z=t.getInstance(y);p.contains(y,z.getActive())&&z.hide();});},hideNub:function(y){n.hide(y);this.hide(y);},setUseMaxHeight:function(y,z){n.conditionClass(y,'maxHeight',z!==false);this._resizeNubFlyout(y);},_resizeNubFlyout:function(y){var z=this._findFlyout(y);if(!z||n.hasClass(y,'placeholder')||!(n.hasClass(y,'openToggler')||n.hasClass(y,'opened')))return;var aa=p.find(z,'div.fbNubFlyoutOuter'),ba=p.find(aa,'div.fbNubFlyoutInner'),ca=p.find(ba,'div.fbNubFlyoutBody'),da=r.getTop(ca),ea=ca.offsetHeight;s.set(ca,'height','auto');var fa=u.getElementDimensions(z),ga=u.getElementDimensions(ca),ha=this.getMaxFlyoutHeight(y);s.set(z,'max-height',ha+'px');s.set(aa,'max-height',ha+'px');fa=u.getElementDimensions(z);var ia=u.getElementDimensions(ba),ja=ia.y-ga.y,ka=fa.y-ja,la=parseInt(ca.style.height||ca.clientHeight,10),ma=ka!==la;if(fa.y>ja&&ma)s.set(ca,'height',ka+'px');n.removeClass(z,'swapDirection');var na=u.getElementPosition(z).x;n.conditionClass(z,'swapDirection',(function(){if(na<0)return true;return na+fa.x>this.viewportDimensions.x;}).bind(this)());if(ma&&da+ea>=ga.y){r.setTop(ca,ca.scrollHeight);}else r.setTop(ca,da);this.notifyNub(y,'resize');},getMaxFlyoutHeight:function(y){var z=this._findFlyout(y),aa=u.getElementPosition(z,'viewport'),ba=u.getElementDimensions(z),ca=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-aa.y-ba.y);return Math.max(ca,0);},resizeAllFlyouts:function(){var y=this._getAllNubs(),z=y.length;while(z--)this._resizeNubFlyout(y[z]);},hideAllFlyouts:function(){var y=this._getAllNubs(),z=y.length;while(z--)this.hide(y[z]);},_getAllNubs:function(){var y=p.scry(this.rootEl,"div._50-v.openToggler");return y.concat(p.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var y=event.getTarget(),z=q.byClass(y,'fbNub');if(z){if(q.byClass(y,'fbNubFlyoutTitlebar')){var aa=q.byTag(y,'a'),ba=y.nodeName=='INPUT'&&y.getAttribute('type')=='submit';if(!aa&&!ba){this.hide(z);return false;}}this.notifyNub(z,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(y){return n.hasClass(y,'fbNubFlyout')?y:p.scry(y,'div.fbNubFlyout')[0]||null;},registerNubController:function(y,z){o.set(y,'dock:nub:controller',z);z.subscribe('nub/button/content-changed',i(this.inform,this,'resize',y));z.subscribe('nub/flyout/content-changed',i(this._resizeNubFlyout,this,y));},unregisterNubController:function(y){o.remove(y,'dock:nub:controller');},notifyNub:function(y,z,aa){var ba=o.get(y,'dock:nub:controller');ba&&ba.inform(z,aa);}});f.exports=b.Dock||x;},null);
__d('PureStoreBasedStateMixin',['StoreBasedStateMixinHelper','invariant','setImmediate'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=(function(){for(var l=arguments.length,m=Array(l),n=0;n<l;n++)m[n]=arguments[n];return {getInitialState:function(){return this.constructor.calculateState();},componentWillMount:function(){!this.constructor.calculateState?i(0):undefined;this._recalculateStateID=null;var o=(function(){if(this.isMounted())this.setState(this.constructor.calculateState());this._recalculateStateID=null;}).bind(this);this._mixin=new h(m);this._mixin.subscribeCallback((function(){if(this._recalculateStateID===null)this._recalculateStateID=j(o);}).bind(this));},componentWillUnmount:function(){this._mixin.release();this._mixin=null;}};}).bind(this);f.exports=k;},null);
__d('MercuryChannelMessageTransformer',['MercuryActionType'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j,k){var l={author:j.mercury_author_id,author_email:j.mercury_author_email,body:j.body,subject:j.subject,has_attachment:j.has_attachment,attachments:j.attachments,ephemeral_ttl_mode:j.ephemeral_ttl_mode,html_body:j.html_body,thread_id:j.tid,thread_fbid:j.thread_fbid&&j.thread_fbid.toString(),other_user_fbid:j.other_user_fbid&&j.other_user_fbid.toString(),offline_threading_id:j.offline_threading_id,message_id:j.mid,is_spoof_warning:j.is_spoof_warning,ranges:j.ranges,source:j.mercury_source,source_tags:j.mercury_source_tags,tags:j.tags&&j.tags.split(','),threading_id:j.threading_id,timestamp:j.timestamp,timestamp_absolute:j.timestamp_absolute,timestamp_relative:j.timestamp_relative,timestamp_datetime:j.timestamp_datetime,timestamp_time_passed:j.timestamp_time_passed,action_type:h.USER_GENERATED_MESSAGE,is_unread:j.is_unread,is_forward:false,forward_count:j.forward_count||j.forward,forward_message_ids:j.forward_msg_ids,folder:k,sync_id:undefined,action_id:undefined};if('sync_id' in j){l.sync_id=j.sync_id;}else l.action_id=j.action_id;return l;}f.exports={transform:i};},null);
__d('QE',['Banzai','Cache'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='qe_log_exposure',k=60,l=new i(),m={logExposure:function(n,o){var p=o?n+'|'+o:n;if(l.has(p))return;var q={signal:true},r={name:n,id:null};if(o)r.id=o;h.post(j,r,q);l.set(p,true,1,k);}};f.exports=m;},null);
__d('DropdownContextualHelpLink',['DOM','ge'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={set:function(k){var l=i('navHelpCenter');if(l!==null)h.replace(l,k);}};f.exports=j;},null);
__d('WaterfallIDGenerator',['CurrentUser','md5'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(){var m=2147483647;return Math.random()*m;}function k(){return Math.floor(Date.now()/1000);}var l={generate:function(){return i([h.getID(),k(),j()].join(':'));}};f.exports=l;},null);
__d('ChatBehavior',['Arbiter','AvailableList','AvailableListConstants','ChatNotificationConstants'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=false,m=i.getWebChatNotification&&i.getWebChatNotification(),n=l,o=true,p=Object.assign(new h(),{ON_CHANGED:'changed',notifiesUserMessages:function(){return m!==k.NO_USER_MESSAGE_NOTIFICATION;},ignoresRemoteTabRaise:function(){return n;},showsTabUnreadUI:function(){return o;}});function q(){p.inform(p.ON_CHANGED);}i.subscribe&&i.subscribe(j.ON_CHAT_NOTIFICATION_CHANGED,function(){var r=m,s=i.getWebChatNotification();m=s;if(r!=s)q();});h.subscribe('chat/set_does_page_occlude_tabs',function(r,s){n=!!s;q();});h.subscribe('chat/set_show_tab_unread_ui',function(r,s){o=!!s;q();});f.exports=p;},null);
__d('Dcode',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h,i={},j={_:'%',A:'%2',B:'000',C:'%7d',D:'%7b%22',E:'%2c%22',F:'%22%3a',G:'%2c%22ut%22%3a1',H:'%2c%22bls%22%3a',I:'%2c%22n%22%3a%22%',J:'%22%3a%7b%22i%22%3a0%7d',K:'%2c%22pt%22%3a0%2c%22vis%22%3a',L:'%2c%22ch%22%3a%7b%22h%22%3a%22',M:'%7b%22v%22%3a2%2c%22time%22%3a1',N:'.channel%22%2c%22sub%22%3a%5b',O:'%2c%22sb%22%3a1%2c%22t%22%3a%5b',P:'%2c%22ud%22%3a100%2c%22lc%22%3a0',Q:'%5d%2c%22f%22%3anull%2c%22uct%22%3a',R:'.channel%22%2c%22sub%22%3a%5b1%5d',S:'%22%2c%22m%22%3a0%7d%2c%7b%22i%22%3a',T:'%2c%22blc%22%3a1%2c%22snd%22%3a1%2c%22ct%22%3a',U:'%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',V:'%2c%22blc%22%3a0%2c%22snd%22%3a0%2c%22ct%22%3a',W:'%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a',X:'%2c%22ri%22%3a0%7d%2c%22state%22%3a%7b%22p%22%3a0%2c%22ut%22%3a1',Y:'%2c%22pt%22%3a0%2c%22vis%22%3a1%2c%22bls%22%3a0%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',Z:'%2c%22sb%22%3a1%2c%22t%22%3a%5b%5d%2c%22f%22%3anull%2c%22uct%22%3a0%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a'};(function(){var l=[];for(var m in j){i[j[m]]=m;l.push(j[m]);}l.reverse();h=new RegExp(l.join("|"),'g');})();var k={encode:function(l){return encodeURIComponent(l).replace(/([_A-Z])|%../g,function(m,n){return n?'%'+n.charCodeAt(0).toString(16):m;}).toLowerCase().replace(h,function(m){return i[m];});},decode:function(l){return decodeURIComponent(l.replace(/[_A-Z]/g,function(m){return j[m];}));}};f.exports=k;},null);
__d('PresenceCookieManager',['Cookie','CurrentUser','Dcode','ErrorUtils','JSLogger','PresenceInitialData','PresenceUtil','URI'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=m.cookieVersion,q=m.dictEncode,r='presence',s={},t=null,u=null,v=l.create('presence_cookie');function w(){try{var aa=h.get(r);if(t!==aa){t=aa;u=null;if(aa&&aa.charAt(0)=='E')aa=j.decode(aa.substring(1));if(aa)u=JSON.parse(aa);}if(u){if(u.user&&u.user!==i.getID())return null;if(u.v!==p)return null;return u;}}catch(z){v.warn('getcookie_error',z);}return null;}function x(){return parseInt(Date.now()/1000,10);}var y={register:function(z,aa){s[z]=aa;},store:function(){var z=w();if(z&&z.v&&p<z.v){v.debug('stale_cookie',p);return;}var aa={v:p,time:x(),user:i.getID()};for(var ba in s)aa[ba]=k.applyWithGuard(s[ba],s,[z&&z[ba]],function(fa){fa.presence_subcookie=ba;});var ca=JSON.stringify(aa);if(q)ca='E'+j.encode(ca);if(n.hasUserCookie()){var da=ca.length;if(da>1024)v.warn('big_cookie',da);var ea=o.getRequestURI(false).isSecure()&&!!h.get('csm');h.set(r,ca,null,null,ea);}},clear:function(){h.clear(r);},getSubCookie:function(z){var aa=w();if(!aa)return null;return aa[z];}};f.exports=y;},null);
__d('PresenceState',['Arbiter','ErrorUtils','JSLogger','PresenceCookieManager','debounceAcrossTransitions','setIntervalAcrossTransitions','PresenceInitialData'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=n.cookiePollInterval||2000,p=n.shouldSuppress||false,q=[],r=[],s=null,t=null,u=0,v=null,w=0,x=['sb2','t2','lm2','uct2','tr','tw','at','wml'],y=j.create('presence_state');function z(){return k.getSubCookie('state');}function aa(){u=Date.now();k.store();ea(t);}var ba=l(aa,0);function ca(ja){if(typeof ja=='undefined'||isNaN(ja)||ja==Number.POSITIVE_INFINITY||ja==Number.NEGATIVE_INFINITY)ja=0;return ja;}function da(ja){var ka={};if(ja){x.forEach(function(na){ka[na]=ja[na];});if(u<ja.ut)y.error('new_cookie',{cookie_time:ja.ut,local_time:u});}ka.ut=u;for(var la=0,ma=q.length;la<ma;la++)i.applyWithGuard(q[la],null,[ka]);t=ka;return t;}function ea(ja){w++;u=ca(ja.ut);if(!s)s=m(ha,o);t=ja;if(v===null)v=ja;for(var ka=0,la=r.length;ka<la;ka++)i.applyWithGuard(r[ka],null,[ja]);w--;}function fa(ja){if(ja&&ja.ut)if(u<ja.ut){return true;}else if(ja.ut<u)y.error('old_cookie',{cookie_time:ja.ut,local_time:u});return false;}function ga(){var ja=z();if(fa(ja))t=ja;return t;}function ha(){var ja=z();if(fa(ja))ea(ja);}k.register('state',da);h.subscribe(j.DUMP_EVENT,function(ja,ka){ka.presence_state={initial:babelHelpers._extends({},v),state:babelHelpers._extends({},t),update_time:u,sync_paused:w,poll_time:o};});(function(){var ja=ga();if(ja){ea(ja);}else{y.debug('no_cookie_initial');ea(da());return;}})();var ia={doSync:function(ja){if(w)return;if(ja){aa();}else ba();},registerStateStorer:function(ja){q.push(ja);},registerStateLoader:function(ja){r.push(ja);},get:function(){return ga();},getInitial:function(){return v;},shouldSuppress:function(){return p;},verifyNumber:ca};f.exports=ia;},null);
__d('ChatCookieInterface',['ChatConfig','InitialServerTime','MercuryIDs','LogHistory','PresenceState','PresenceUtil'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=k.getInstance('chat_cookie'),o=i.serverTime,p=h.get('tab_max_load_age')||3600000,q=o-p,r={store:function(v,w){if(v.uct2==w.lastChangeTime)return v;var x=u(v,w),y={};if(!x){y.old_tabs=v&&v.t2&&JSON.stringify(v.t2);y.old_promoted=v&&v.lm2;y.old_time=v&&v.uct2;y.old_reason=v&&v.tr;y.old_window=v&&v.tw;var z=[];w.tabs.forEach(function(aa){if(!aa.fragile||aa.server_id){var ba={i:aa.fragile?j.getThreadIDFromThreadFBID(aa.server_id):aa.id,si:aa.server_id};if(aa.raised)ba.r=1;z.push(ba);}});v.t2=z;v.lm2=w.promotedID;v.uct2=w.lastChangeTime;v.tr=w.lastChangeReason;v.tw=m.getSessionID();n.debug('store','{}');}else n.warn('store_bad_state','{}');return v;},load:function(v,w){if(!v){n.warn('load_bad_state','{}');return false;}var x=u(v,w);if(!x||x===w.lastChangeTime)return false;w.lastChangeTime=x;w.lastChangeReason='load';var y=s(w,v.t2,v.lm2||null),event='load';if(!w.isInitialized)event+='_init';n.log(event,'{}');return y;},tabsChanged:function(){return t.apply(undefined,arguments);}};function s(v,w,x){var y;if(!t(v,w,x))return false;var z=v.tabs.filter(function(ca){return !!ca.fragile;}),aa={};v.promotedID=null;v.tabs=w.map(function(ca){var da={id:ca.i,server_id:ca.si};if(da.id==x)v.promotedID=da.id;if(ca.r)da.raised=true;aa[da.id]=da;return da;});v.tabs=v.tabs.filter(function(ca){return !!ca;});if(v.localRaised)for(var ba in v.localRaised)if(!aa[ba]||!aa[ba].raised)delete v.localRaised[ba];z=z.filter(function(ca){return !aa[ca.id];});(y=v.tabs).push.apply(y,z);return true;}function t(v,w,x){if(x&&x!=v.promotedID)return true;var y=v.tabs.filter(function(ba){return !ba.fragile||ba.server_id;});if(w.length!=y.length)return true;for(var z=0,aa=w.length;z<aa;z++)if(!!w[z].r!==y[z].raised||!w[z].si&&w[z].i!==y[z].id||w[z].si&&w[z].si!==y[z].server_id)return true;return false;}function u(v,w){var x=l.verifyNumber(v.uct2);if(!x||typeof x!=='number'){n.warn('bad_cookie_version','{}');return null;}if(x<w.lastChangeTime||x<q)return null;return x;}f.exports=r;},null);
__d('ChatTabModel',['Arbiter','ChatBehavior','ChatDispatcher','ChatConfig','ChatCookieInterface','ChatTabActions','EventEmitter','InitialServerTime','LogHistory','JSLogger','MercuryAssert','MercuryIDs','MercuryLocalIDs','PresenceState','PresenceUtil','MercuryThreadIDMap','MercuryThreads','MercuryTimestampTracker'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=c('MercuryThreadIDMap').get(),x=c('MercuryThreads').get(),y=c('MercuryTimestampTracker').get(),z=o.serverTime,aa=k.get('tab_max_load_age')||3600000,ba=20,ca=new n(),da=p.getInstance('chat_tab_model'),ea={tabs:[],promotedID:null,lastChangeTime:0,lastChangeReason:null,isInitialized:false,localRaised:null};function fa(bb){var cb=l.load(bb,ea);cb&&ja();return cb;}function ga(bb,cb,db){var eb=fa(u.get());if(cb===undefined||cb>ea.lastChangeTime){if(bb()){eb=true;ea.lastChangeReason=db||null;ia(cb);}}else da.error('rejected',JSON.stringify({change_time:cb,state_time:ea.lastChangeTime}));eb&&ha();}function ha(){if(ea.isInitialized)ca.emit('change');}function ia(bb){if(bb===undefined)bb=Math.max(y.getLastUserMessageTimestamp()||1,ea.lastChangeTime+1);ea.lastChangeTime=bb;u.doSync();}function ja(bb){var cb=ea.tabs.length-ba;if(cb>0)ea.tabs=ea.tabs.filter(function(db){return db.raised||db.id==bb||cb--<=0;});if(cb>0)ea.tabs=ea.tabs.filter(function(db){return (db.id==ea.promotedID||db.id==bb||cb--<=0);});}function ka(bb){for(var cb=0;cb<ea.tabs.length;cb++)if(ea.tabs[cb].id==bb)return cb;return -1;}function la(bb,cb){var db=x.getThreadMetaNow(bb);if(!db)return false;if(db.is_canonical_user){return oa(bb,cb);}else{var eb=na(bb);if(eb)w.getServerIDFromClientID(bb,function(fb){if(ra(bb,fb)){ia();ha();}});return eb;}}function ma(bb){r.isThreadID(bb);if(na(bb))ha();}function na(bb){if(ka(bb)===-1){ea.tabs.push({id:bb,fragile:true});da.log('open_fragile_tab',JSON.stringify({tabs:JSON.stringify(ea.tabs),opened:bb,window_id:v.getSessionID()}));return true;}return false;}function oa(bb,cb){var db=ka(bb);if(db!=-1)if(ea.tabs[db].fragile){ea.tabs.splice(db,1);}else{cb&&(ea.tabs[db].signatureID=cb);return true;}for(var eb=0;eb<=ea.tabs.length;eb++)if(eb==ea.tabs.length||ea.tabs[eb].fragile){ea.tabs.splice(eb,0,{id:bb,signatureID:cb});ja(bb);da.log('open_tab',JSON.stringify({tabs:JSON.stringify(ea.tabs),opened:bb,window_id:v.getSessionID()}));return true;}}function pa(bb,cb,db){r.isThreadID(bb);var eb=false;if(ea.localRaised&&cb){ea.localRaised[bb]=true;eb=true;}ga(function(){if(la(bb,db))eb=true;var fb=ka(bb);if(fb!=-1&&!ea.tabs[fb].raised){ea.tabs[fb].raised=true;eb=true;da.log('raise_tab',JSON.stringify({tabs:JSON.stringify(ea.tabs),raised:bb,window_id:v.getSessionID()}));}return eb;});}function qa(bb){if(ka(bb)!==-1&&ea.promotedID!==bb){ea.promotedID=bb;return true;}return false;}function ra(bb,cb){var db=ka(bb);if(db!=-1&&ea.tabs[db].fragile){var eb=ea.tabs[db];eb.fragile=s.isLocalThread(bb);eb.server_id=cb;var fb=[];ea.tabs.forEach(function(gb){if(gb.id!=bb){if(eb&&gb.fragile){fb.push(eb);eb=null;}fb.push(gb);}});if(eb)fb.push(eb);ea.tabs=fb;da.log('make_permanent',JSON.stringify({tabs:JSON.stringify(ea.tabs),tab_id:bb,window_id:v.getSessionID()}));return true;}return false;}function sa(bb,cb){r.isThreadID(bb);var db=false;if(ea.localRaised){delete ea.localRaised[bb];db=true;}ga(function(){if(ta(bb))db=true;return db;},undefined,cb);}function ta(bb){var cb=ka(bb);if(bb==ea.promotedID)ea.promotedID=null;if(cb!=-1){ea.tabs.splice(cb,1);da.log('close_tab',JSON.stringify({tabs:JSON.stringify(ea.tabs),closed:bb,window_id:v.getSessionID()}));return true;}return false;}function ua(){if(ea.tabs.length){da.log('close_all_tabs',JSON.stringify({closed_tabs:JSON.stringify(ea.tabs),window_id:v.getSessionID()}));ea.tabs=[];ea.promotedID=null;if(ea.localRaised)ea.localRaised={};ia();ha();}}function va(){var bb=[];for(var cb=0;cb<ea.tabs.length;cb++)if(ea.tabs[cb].fragile&&!x.isNewEmptyLocalThread(ea.tabs[cb].id)){bb.push(ea.tabs[cb]);ea.tabs.splice(cb);ha();break;}da.log('close_fragile_tabs',JSON.stringify({tabs:JSON.stringify(ea.tabs),fragile_closed:bb,window_id:v.getSessionID()}));}function wa(bb){r.isThreadID(bb);var cb=false;if(ea.localRaised){delete ea.localRaised[bb];cb=true;}ga(function(){var db=ka(bb);if(db!=-1&&ea.tabs[db].raised){delete ea.tabs[db].raised;da.log('lower_tab',JSON.stringify({tabs:JSON.stringify(ea.tabs),lowered:bb,window_id:v.getSessionID()}));cb=true;}return cb;});}function xa(){if(ea.localRaised){ga(function(){var bb=false;ea.tabs.forEach(function(cb){if(cb.raised!=ea.localRaised[cb.id]){bb=true;if(ea.localRaised[cb.id]){cb.raised=true;}else delete cb.raised;}});return bb;});da.log('persist_local_raise',JSON.stringify({tabs:JSON.stringify(ea.tabs),window_id:v.getSessionID()}));}}u.registerStateStorer(function(bb){return l.store(bb,ea);});u.registerStateLoader(function(bb){if(fa(bb))ha();});var ya=null,za={getDispatchToken:function(){return ya;},isTabPromoted:function(bb){if(bb)return bb==ea.promotedID;return false;},indexOf:function(bb){return ka(bb);},getTab:function(bb){r.isThreadID(bb);var cb=this.indexOf(bb);if(cb>-1){var db=ea.tabs[cb];return babelHelpers._extends({},db);}return null;},getEmptyTab:function(){var bb;for(var cb=0;cb<ea.tabs.length;cb++){bb=ea.tabs[cb].id;if(x.isNewEmptyLocalThread(bb))return bb;}bb=t.generateThreadID();x.createNewLocalThread(bb,[]);return bb;},get:function(){var bb=ea.tabs.map(function(cb){var db=babelHelpers._extends({},cb);delete db.fragile;if(ea.localRaised)db.raised=ea.localRaised[db.id];return db;});return {tabs:bb,promoted:ea.promotedID};},promoteThreadInPlaceOfThread:function(bb,cb,db,eb){r.isThreadID(bb);r.isThreadID(cb);ga(function(){var fb=ka(bb),gb=ka(cb);if(eb){ea.promotedID=bb;}else if(ea.promotedID===cb)return true;var hb=ea.tabs[fb];if(db){r.isThreadID(db);var ib=ka(db),jb=ea.tabs[gb];ea.tabs[gb]=hb;ea.tabs.splice(fb,1);ea.tabs.splice(ib,0,jb);}else{ea.tabs[fb]=ea.tabs[gb];ea.tabs[gb]=hb;}return true;});},addListener:function(bb){return ca.addListener('change',bb);}};h.subscribe(q.DUMP_EVENT,function(bb,cb){cb.chat_tabs={promoted:ea.promotedID,tabs:ea.tabs.map(function(db){return babelHelpers._extends({},db);}),time:ea.lastChangeTime,max_load_age:aa};});function ab(){var bb=i.ignoresRemoteTabRaise();if(bb&&!ea.localRaised){da.log('start_ignore_remote_raise','{}');ea.localRaised={};ha();}else if(!bb&&ea.localRaised){da.log('stop_ignore_remote_raise','{}');ea.localRaised=null;ha();}}ya=j.register(function(bb){switch(bb.actionType){case m.Types.CLOSE_TAB:sa(bb.threadID,bb.reason);break;case m.Types.CLOSE_ALL_TABS:ua();break;case m.Types.CLOSE_FRAGILE_TABS:va();break;case m.Types.LOWER_TAB:wa(bb.threadID);break;case m.Types.OPEN_FRAGILE_TAB:ma(bb.threadID);break;case m.Types.OPEN_TAB:r.isThreadID(bb.threadID);ga(function(){return la(bb.threadID);});break;case m.Types.PERSIST_LOCAL_STATE:xa();break;case m.Types.PROMOTE_TAB:r.isThreadID(bb.threadID);ga(qa.bind(null,bb.threadID));break;case m.Types.RAISE_TAB:pa(bb.threadID,bb.userAction,bb.signatureID);break;}});i.subscribe(i.ON_CHANGED,ab);ab();fa(u.getInitial(),true);if(ea.lastChangeTime===0)ea.lastChangeTime=z-600000;ea.isInitialized=true;f.exports=za;},null);
__d('ChatTabPolicy',['ChatBehavior','JSLogger','MercuryActionType','MercuryLogMessageType','MercuryAssert','MercuryConfig','MercuryGroupThreadMentions','MercuryIDs','MercuryParticipantTypes','MercurySourceType','MercuryThreadInfo','MercuryViewer','MessagingTag','OzConstants','PresencePrivacy','Set','ShortProfiles','WorkModeConfig','MercuryBlockedParticipants','MercuryThreadActions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();var z=c('MercuryBlockedParticipants').get(),aa=c('MercuryThreadActions').get(),ba=u.M_FBIDS,ca=ba.M_DEV,da=ba.M,ea=ba.P,fa=new w([ca,da,ea]),ga=i.create('tab_policy');f.exports={messageIsAllowed:function(ha,ia,ja){var ka=ha.thread_id,la=ia.message_id;l.isThreadID(ka);l.isParticipantID(ia.author);var ma;if(r.isMuted(ha)){ma={thread_id:ka,message_id:la,mute_settings:ha.mute_settings};ga.log('message_thread_muted',ma);if(m.GroupChatMentionsGK)n.messageMentionsViewer(ia,function(pa){if(pa)ja();});return;}if(ha.read_only){ma={thread_id:ka,message_id:la,mode:ha.mode};ga.log('message_read_only',ma);return;}if(ia.source==q.EMAIL||ia.source==q.TITAN_EMAIL_REPLY){ma={thread_id:ka,message_id:la,source:ia.source};ga.log('message_source_not_allowed',ma);return;}var na=o.getUserIDFromParticipantID(ia.author);if(!na){ga.log('message_bad_author',{thread_id:ka,message_id:la,user:na});return;}if(ia.action_type!=j.USER_GENERATED_MESSAGE&&!this._messageIsNewlyCreatedGroup(ia,ha)){ma={thread_id:ka,message_id:la,type:ia.action_type};ga.log('message_non_user_generated',ma);return;}if(ha.is_canonical_user&&!h.notifiesUserMessages()){ga.log('message_jabber',{thread_id:ka,message_id:la});aa.markSeen(ka,true);return;}if(ha.is_canonical&&!ha.other_user_fbid){ga.log('message_canonical_contact',{thread_id:ka,message_id:la});return;}if(ha.folder!=t.INBOX){ga.log('message_folder',{thread_id:ka,message_id:la,folder:ha.folder});return;}if(z.isPresentInGroupThread(ha)){ma={thread_id:ka,message_id:la};ga.log('message_blocked_participants',ma);return;}var oa=o.getUserIDFromParticipantID(s.getID());x.getMulti([na,oa],function(pa){if(!v.allows(na)){ga.log('message_privacy',{thread_id:ka,message_id:la,user:na});return;}var qa=pa[na].employee&&pa[oa].employee,ra=y.is_work_user;if(!qa&&!ra&&!pa[na].isCommercePage&&!fa.has(na)&&pa[na].type!==p.FRIEND){ga.log('message_non_friend',{thread_id:ka,message_id:la,user:na});return;}ja();});},_messageIsNewlyCreatedGroup:function(ha,ia){return ha.action_type===j.LOG_MESSAGE&&ha.log_message_type===k.THREAD_NAME&&ia.message_count===1;}};},null);
__d('URLScraper',['ArbiterMixin','DataStore','Event','URLMatcher','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n,o='scraperLastPermissiveMatch';m=babelHelpers.inherits(p,l(h));n=m&&m.prototype;function p(q,r){'use strict';n.constructor.call(this);this.input=q;this.enable();this.getValueFn=r;}p.prototype.reset=function(){'use strict';i.set(this.input,o,null);};p.prototype.enable=function(){'use strict';if(this.events)return;var q=function(r){setTimeout(this.check.bind(this,r),30);};this.events=j.listen(this.input,{paste:q.bind(this,false),keydown:q.bind(this,true)});};p.prototype.disable=function(){'use strict';if(!this.events)return;for(var event in this.events)this.events[event].remove();this.events=null;};p.prototype.check=function(q){'use strict';var r=this.getValueFn?this.getValueFn():this.input.value;if(q&&p.trigger(r))return;var s=p.match(r),t=k.permissiveMatch(r);if(t&&t!=i.get(this.input,o)){i.set(this.input,o,t);this.inform('match',{url:s||t,alt_url:t});}};Object.assign(p,k);f.exports=p;},null);
__d('ChatBubble.react',['Animation','ChatProgressBar.react','DOMDimensions','EmojiLikeUtils','EmojiOnlyMessage.react','MercuryAttachment','MercuryMessageBody.react','MercuryTagHelper','MessageBubbleMixin','MessagingGiftWrap.react','React','ReactDOM','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v=r.PropTypes,w=1000,x=r.createClass({displayName:'ChatBubble',_boxWidth:0,mixins:[p],propTypes:{attachments:v.node,body:v.string,customLike:v.object,isEmojiLike:v.bool,isGiftWrapped:v.bool,isMessageAuthor:v.bool,maxWidth:v.number.isRequired,onUnwrap:v.func,threadID:v.string,timestamp:v.number,ttl:v.number},getInitialState:function(){return {emojis:undefined,ephemeralExpiring:false,ephemeralExpired:false};},componentDidMount:function(){if(this.props.attachments&&!this.props.isEmojiLike)return;if(!this.props.emojis){var y=this.props.body||'',z=k.richContent(y);if(z)this.setState({emojis:z});}},render:function(){var y=this.props.body||'';return (r.createElement('div',babelHelpers._extends({},this.props,{className:u("_5w1r"+(this._isEpehmeralStylePreferred()?' '+"_4gx-":'')+(this.state.ephemeralExpiring?' '+"_1xti":'')+(this.state.ephemeralExpired?' '+"_1xtj":'')+(!this.state.emojis?' '+"_3_om":'')+(!!this.state.emojis?' '+"_31xx":''),this.props.className),ref:'bubble',style:{maxWidth:this.props.maxWidth,width:this.state.emojis?null:this.state.bubbleWidth,wordWrap:y.length>=15?'break-word':'inherit'}}),this._renderProgressBar(),r.createElement('div',{className:"_4gx_",ref:'inner'},this._renderContent(),this.props.attachments),this.props.isGiftWrapped?r.createElement(q,{onUnwrap:this.props.onUnwrap}):null));},_renderContent:function(){if(!this.props.body||this.props.isEmojiLike)return null;if(this.state.emojis){var y=k.getSourceURIs(this.state.emojis),z=r.createElement(l,{sourceURIs:y});}else z=r.createElement(n,{body:this.props.body,ranges:this.props.ranges,threadID:this.props.threadID,customLike:this.props.customLike});return (r.createElement('div',{className:"_d97"+(!!this.state.emojis?' '+"_31xy":''),ref:'contentWrapper'},r.createElement('span',{className:"_5yl5",ref:'content'},z)));},_isEpehmeralStylePreferred:function(){if(!this.props.ttl)return false;if(!this.props.attachments)return true;return this.props.attachments.props.attachments.every(function(y){return m.isEphemeralTextStyle(y);});},_onProgressBarAnimationDone:function(){if(this.isMounted()){this.setState({ephemeralExpiring:true});new h(this.refs.inner).to('opacity',0).duration(w).go();}},_setExpiredAnimation:function(){if(this.isMounted()){this.setState({ephemeralExpiring:true});this.setState({ephemeralExpired:true});}},_renderProgressBar:function(){if(!this.props.timestamp||!this.props.ttl||!this._isEpehmeralStylePreferred()||this.state.emojis&&this.state.emojis.length>0)return null;return (r.createElement(i,{ttl:this.props.ttl,timestamp:this.props.timestamp,isMessageAuthor:this.props.isMessageAuthor,onDone:this._onProgressBarAnimationDone,setExpiredAnimation:this._setExpiredAnimation}));},contentWraps:function(){var y=s.findDOMNode(this.refs.content),z=y.getClientRects(),aa=j.getElementDimensions(y).height;return z&&z.length>1&&z[0].height<aa;},getBoxWidth:function(){if(!this._boxWidth)this._boxWidth=j.measureElementBox(s.findDOMNode(this.refs.bubble),'width',true,true,false);return this._boxWidth;}});f.exports=x;},null);
__d('MercuryDelayedDispatcher',['MercuryDispatcher','MercuryServerPayloadPreprocessor','MercuryServerRequests','MercurySingletonProvider','MercuryThreadIDMap'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();function m(o){this.$MercuryDelayedDispatcher1=o;this.$MercuryDelayedDispatcher2=[];this.$MercuryDelayedDispatcher3=l.getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher4=h.getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher5=j.getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher6=i.getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher4.subscribe('model-update-completed',(function(p,q){return this.$MercuryDelayedDispatcher7();}).bind(this));}m.getForFBID=function(o){return n.getForFBID(o);};m.get=function(){return n.get();};m.prototype.handleUpdateWaitForThread=function(o,p){var q=this.$MercuryDelayedDispatcher3.getClientIDFromServerIDNow(p);if(q){this.$MercuryDelayedDispatcher8(o);return;}this.$MercuryDelayedDispatcher3.getClientIDFromServerID(p,(function(){return this.$MercuryDelayedDispatcher2.push(o);}).bind(this));this.$MercuryDelayedDispatcher5.ensureThreadIsFetched(p);};m.prototype.$MercuryDelayedDispatcher7=function(){if(this.$MercuryDelayedDispatcher2&&this.$MercuryDelayedDispatcher2.length){var o=this.$MercuryDelayedDispatcher2[0];this.$MercuryDelayedDispatcher2=this.$MercuryDelayedDispatcher2.slice(1);this.$MercuryDelayedDispatcher8(o);}};m.prototype.$MercuryDelayedDispatcher8=function(o){if(o.from_client){this.$MercuryDelayedDispatcher4.handleUpdate(o);}else this.$MercuryDelayedDispatcher6.handleUpdate(o);};var n=new k(m);f.exports=m;},null);
__d('MercuryChannelHandler',['Arbiter','ChannelConstants','MercuryActionType','MercuryChannelMessageTransformer','MercuryConfig','MercuryDelayedDispatcher','MercuryGlobalActionType','MercuryLogMessageType','MercuryMessages','MercuryPayloadSource','MercuryServerPayloadPreprocessor','MercurySingletonMixin','MercuryThreadInformer','MercuryViewer','MessagingEvent','MessagingTag','PresenceUtil','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();var z,aa;z=babelHelpers.inherits(ba,y(s));aa=z&&z.prototype;function ba(ca){'use strict';aa.constructor.call(this);this.$MercuryChannelHandler1=ca;this.__payloadPreprocessor=r.getForFBID(this.$MercuryChannelHandler1);this.$MercuryChannelHandler2=t.getForFBID(this.$MercuryChannelHandler1);this.$MercuryChannelHandler3=p.getForFBID(this.$MercuryChannelHandler1);this.__delayedDispatcher=m.getForFBID(this.$MercuryChannelHandler1);this.$MercuryChannelHandler4=[];}ba.prototype.getInstanceFBID=function(){'use strict';return this.$MercuryChannelHandler1;};ba.prototype.$MercuryChannelHandler5=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj||!da.obj.message)return;var ea=da.obj.message,fa=ea.other_user_fbid?ea.other_user_fbid:ea.thread_fbid;fa=fa.toString();var ga=k.transform(ea,da.obj.folder);if(this.__shouldDropMessageBecauseOfSync(ea))return;var ha=[babelHelpers._extends({},ga)];ha=ha.concat(ea.forward_actions||[]);var ia=q.CLIENT_CHANNEL_MESSAGE;this.__delayedDispatcher.handleUpdateWaitForThread({actions:ha,payload_source:ia},fa);};ba.prototype.$MercuryChannelHandler7=function(ca,da){'use strict';if(l.WWWSyncDeliveryReceipt)return;var ea=da.obj.other_user_fbid,fa=da.obj.thread_fbid;if(!this.$MercuryChannelHandler6(ca)||!ea&&!fa)return;this.__payloadPreprocessor.handleUpdate({delivery_receipts:[{other_user_fbid:ea?ea.toString():'',thread_fbid:fa?fa.toString():'',time:da.obj.timestamp}]});};ba.prototype.$MercuryChannelHandler8=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj||!da.obj.thread_fbids&&!da.obj.other_user_fbids)return;var ea=[],fa=da.obj.event==v.READ;if(fa&&l.WWWSyncMarkRead)return;(da.obj.thread_fbids||[]).forEach(function(ga){ea.push({action_type:j.CHANGE_READ_STATUS,action_id:null,thread_fbid:ga,mark_as_read:fa,timestamp:da.obj.timestamp||0,folder:da.obj.folder_info[ga]});});(da.obj.other_user_fbids||[]).forEach(function(ga){ea.push({action_type:j.CHANGE_READ_STATUS,action_id:null,other_user_fbid:ga,mark_as_read:fa,timestamp:da.obj.timestamp||0,folder:da.obj.folder_info[ga]});});this.__payloadPreprocessor.handleUpdate({actions:ea,payload_source:q.CLIENT_CHANNEL_MESSAGE});};ba.prototype.$MercuryChannelHandler9=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj||!(da.obj.thread_fbids||da.obj.other_user_fbids))return;var ea=[];(da.obj.thread_fbids||[]).forEach(function(fa){ea.push({action_type:j.DELETE_THREAD,action_id:null,thread_fbid:fa});});(da.obj.other_user_fbids||[]).forEach(function(fa){ea.push({action_type:j.DELETE_THREAD,action_id:null,other_user_fbid:fa});});this.__payloadPreprocessor.handleUpdate({actions:ea,payload_source:q.CLIENT_CHANNEL_MESSAGE});};ba.prototype.$MercuryChannelHandler10=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj||!da.obj.thread_fbids&&!da.obj.other_user_fbids||!da.obj.mids)return;var ea=da.obj.thread_fbids.length?da.obj.thread_fbids[0]:null,fa=da.obj.other_user_fbids.length?da.obj.other_user_fbids[0]:null,ga={action_type:j.DELETE_MESSAGES,action_id:null,thread_fbid:ea,other_user_fbid:fa,message_ids:da.obj.mids};if(l.MessengerGlobalDeleteGK){if(da.obj.updated_thread)return;this.__payloadPreprocessor.handleUpdate({actions:[ga],payload_source:q.CLIENT_CHANNEL_MESSAGE});return;}this.__payloadPreprocessor.handleUpdate({actions:[ga],payload_source:q.CLIENT_CHANNEL_MESSAGE});};ba.prototype.$MercuryChannelHandler11=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj||!da.obj.folder)return;var ea={action_type:n.MARK_ALL_READ,action_id:da.obj.action_id,folder:da.obj.folder};this.__payloadPreprocessor.handleUpdate({global_actions:[ea]});};ba.prototype.$MercuryChannelHandler12=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj.thread_fbids&&!da.obj.other_user_fbids)return;var ea=q.CLIENT_CHANNEL_MESSAGE;(da.obj.thread_fbids||[]).forEach(function(fa){var ga={action_type:j.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:fa.toString(),other_user_fbid:null,archived:da.obj.state};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},ga)],payload_source:ea},fa.toString());},this);(da.obj.other_user_fbids||[]).forEach(function(fa){var ga={action_type:j.CHANGE_ARCHIVED_STATUS,action_id:null,thread_fbid:null,other_user_fbid:fa.toString(),archived:da.obj.state};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},ga)],payload_source:ea},fa.toString());},this);};ba.prototype.$MercuryChannelHandler13=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj.thread_fbids&&!da.obj.other_user_fbids)return;var ea=q.CLIENT_CHANNEL_MESSAGE,fa;(da.obj.thread_fbids||[]).forEach(function(ga){if(da.obj.event==v.TAG){fa=da.obj.tag;}else fa=da.obj.marked_as_spam?w.SPAM:w.INBOX;var ha={action_type:j.CHANGE_FOLDER,action_id:null,thread_fbid:ga.toString(),other_user_fbid:null,new_folder:fa};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},ha)],payload_source:ea},ga.toString());},this);(da.obj.other_user_fbids||[]).forEach(function(ga){if(da.obj.event==v.TAG){fa=da.obj.tag;}else fa=da.obj.marked_as_spam?w.SPAM:w.INBOX;var ha={action_type:j.CHANGE_FOLDER,action_id:null,other_user_fbid:ga.toString(),thread_fbid:null,new_folder:fa};this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},ha)],payload_source:ea},ga.toString());},this);};ba.prototype.$MercuryChannelHandler14=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj.tag)return;switch(da.obj.tag){case w.ACTION_ARCHIVED:this.$MercuryChannelHandler12(ca,da);break;case w.INBOX:case w.OTHER:this.$MercuryChannelHandler13(ca,da);break;}};ba.prototype.__markAsSeen=function(ca,da){'use strict';if(!this.$MercuryChannelHandler15(ca)||!da.obj||!da.obj.seen_timestamp)return;this.__payloadPreprocessor.handleUpdate({message_counts:[{seen_timestamp:da.obj.seen_timestamp,folder:w.INBOX}],unseen_thread_fbids:[{thread_fbids:[],other_user_fbids:[],folder:w.INBOX}],payload_source:q.CLIENT_CHANNEL_MESSAGE});};ba.prototype.__updateModelsFromMercuryPayload=function(ca,da){'use strict';if(!this.$MercuryChannelHandler16(ca)||!da.obj)return;this.$MercuryChannelHandler2.synchronizeInforms((function(){var ea=da.obj,fa=[];(ea.actions||[]).forEach(function(ga){var ha=j.USER_GENERATED_MESSAGE;if(ga.action_type==j.LOG_MESSAGE){if(this.__shouldDropLogMessageBecauseOfSync(ga))return;var ia=q.CLIENT_CHANNEL_MESSAGE,ja;ja=ga.other_user_fbid||ga.thread_fbid;this.__delayedDispatcher.handleUpdateWaitForThread({actions:[babelHelpers._extends({},ga)],payload_source:ia},ja);}else if(ga.action_type!=ha)fa.push(ga);},this);ea.actions=fa;ea.payload_source=q.CLIENT_CHANNEL_MESSAGE;this.__payloadPreprocessor.handleUpdate(ea);}).bind(this));};ba.prototype.$MercuryChannelHandler17=function(ca,da){'use strict';var ea,fa;if(l.WWWSyncReadReceipt)return;var ga=da.obj.time,ha=da.obj.reader,ia=da.obj.thread_fbid||'';this.__payloadPreprocessor.handleUpdate({roger:(fa={},fa[ia]=(ea={},ea[ha]=ga,ea),fa)});};ba.prototype.$MercuryChannelHandler18=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj||da.obj.message_blocked===undefined||!da.obj.thread_fbid)return;var ea=j.UPDATE_BLOCKER_STATUS,fa=[{action_type:ea,action_id:null,thread_fbid:da.obj.thread_fbid,message_blocked:da.obj.message_blocked,is_blocked_by_recipient:da.obj.is_blocked_by_recipient}];this.__payloadPreprocessor.handleUpdate({actions:fa,payload_source:q.CLIENT_CHANNEL_MESSAGE});};ba.prototype.$MercuryChannelHandler19=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj||da.obj.got_blocked===undefined||!da.obj.thread_fbid)return;var ea=j.UPDATE_BLOCKEE_STATUS,fa=[{action_type:ea,action_id:null,thread_fbid:da.obj.thread_fbid,got_blocked:da.obj.got_blocked}];this.__payloadPreprocessor.handleUpdate({actions:fa,payload_source:q.CLIENT_CHANNEL_MESSAGE});};ba.prototype.$MercuryChannelHandler20=function(ca,da){'use strict';if(!this.$MercuryChannelHandler6(ca)||!da.obj||da.obj.mute_settings===undefined||!da.obj.thread_fbid&&!da.obj.other_user_fbid)return;var ea=j.CHANGE_MUTE_SETTINGS,fa=[{action_type:ea,action_id:null,thread_fbid:da.obj.thread_fbid,other_user_fbid:da.obj.other_user_fbid,mute_settings:da.obj.mute_settings}];this.__payloadPreprocessor.handleUpdate({actions:fa,payload_source:q.CLIENT_CHANNEL_MESSAGE});};ba.prototype.__handleMessagingPayload=function(ca,da){'use strict';switch(da.obj.event){case v.DELIVER:this.$MercuryChannelHandler5(ca,da);break;case v.DELIVERY_RECEIPT:this.$MercuryChannelHandler7(ca,da);break;case v.READ:case v.UNREAD:this.$MercuryChannelHandler8(ca,da);break;case v.READ_ALL:this.$MercuryChannelHandler11(ca,da);break;case v.DELETE:this.$MercuryChannelHandler9(ca,da);break;case v.DELETE_MESSAGES:this.$MercuryChannelHandler10(ca,da);break;case v.TAG:this.$MercuryChannelHandler14(ca,da);break;case v.REPORT_SPAM:this.$MercuryChannelHandler13(ca,da);break;case v.READ_RECEIPT:this.$MercuryChannelHandler17(ca,da);break;case v.CHANGE_MUTE_SETTINGS:this.$MercuryChannelHandler20(ca,da);break;case v.UPDATE_BLOCKER_STATUS:this.$MercuryChannelHandler18(ca,da);break;case v.UPDATE_BLOCKEE_STATUS:this.$MercuryChannelHandler19(ca,da);break;}};ba.prototype.getRouting=function(){'use strict';return {mercury:this.__updateModelsFromMercuryPayload,messaging:this.__handleMessagingPayload,inbox:this.__markAsSeen};};ba.prototype.__getMessagingPayloadType=function(){'use strict';return i.getArbiterType('messaging');};ba.prototype.__getMercuryPayloadType=function(){'use strict';return i.getArbiterType('mercury');};ba.prototype.__getInboxPayloadType=function(){'use strict';return i.getArbiterType('inbox');};ba.prototype.$MercuryChannelHandler6=function(ca){'use strict';return ca==this.__getMessagingPayloadType();};ba.prototype.$MercuryChannelHandler16=function(ca){'use strict';return ca==this.__getMercuryPayloadType();};ba.prototype.$MercuryChannelHandler15=function(ca){'use strict';return ca==this.__getInboxPayloadType();};ba.prototype.turnOn=function(){'use strict';if(!this.$MercuryChannelHandler4.length){var ca=this.getRouting();for(var da in ca)this.$MercuryChannelHandler4.push(h.subscribe(i.getArbiterType(da),ca[da].bind(this)));}return this;};ba.prototype.turnOff=function(){'use strict';if(this.$MercuryChannelHandler4.length){this.$MercuryChannelHandler4.forEach(h.unsubscribe);this.$MercuryChannelHandler4=[];}return this;};ba.prototype.__shouldDropMessageBecauseOfSync=function(ca){'use strict';if(!ca.has_attachment&&l.WWWSyncMsgText){return true;}else if(ca.has_attachment&&l.WWWSyncMsgAttach)return true;return false;};ba.prototype.__shouldDropLogMessageBecauseOfSync=function(ca){'use strict';if(l.WWWSyncMsgLog)switch(ca.log_message_type){case o.UNSUBSCRIBE:case o.SUBSCRIBE:case o.THREAD_NAME:case o.VIDEO_CALL:case o.PHONE_CALL:case o.THREAD_IMAGE:case o.ORION:case o.PAGE_REPLY:case o.GENERIC_ADMIN_TEXT:return true;case o.SERVER_ERROR:case o.LIVE_LISTEN:case o.SWITCH_TO_WORK:case o.WALLPAPER:default:break;}return false;};Object.assign(ba,s);f.exports=ba;},null);
__d('Poller',['ArbiterMixin','AsyncRequest','CurrentUser','emptyFunction','mixin','setTimeoutAcrossTransitions','setTimeout'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o,p;o=babelHelpers.inherits(q,l(h));p=o&&o.prototype;function q(t){'use strict';p.constructor.call(this);this._config=babelHelpers._extends({clearOnQuicklingEvents:true,setupRequest:k,interval:null,maxRequests:Infinity,dontStart:false},t);this._handle=null;if(!this._config.dontStart)this.start();}q.prototype.start=function(){'use strict';if(this._polling)return this;this._requests=0;this.request();return this;};q.prototype.stop=function(){'use strict';this._cancelRequest();return this;};q.prototype.mute=function(){'use strict';this._muted=true;return this;};q.prototype.resume=function(){'use strict';if(this._muted){this._muted=false;if(this._handle===null&&this._polling)return this.request();}return this;};q.prototype.skip=function(){'use strict';this._skip=true;return this;};q.prototype.reset=function(){'use strict';return this.stop().start();};q.prototype.request=function(){'use strict';this._cancelRequest();this._polling=true;if(!s())return this._done();if(this._muted)return this;if(++this._requests>this._config.maxRequests)return this._done();var t=new i();t.setIsBackgroundRequest(true);var u=false;t.setInitialHandler(function(){return !u;});this._cancelRequest=(function(){u=true;this._cleanup();}).bind(this);t.setFinallyHandler(r.bind(this));t.setInitialHandler=k;t.setFinallyHandler=k;this._config.setupRequest(t,this);if(this._skip){this._skip=false;m(r.bind(this),0);}else t.send();return this;};q.prototype.isPolling=function(){'use strict';return this._polling;};q.prototype.isMuted=function(){'use strict';return this._muted;};q.prototype.setInterval=function(t){'use strict';if(t){this._config.interval=t;this.start();}};q.prototype.getInterval=function(){'use strict';return this._config.interval;};q.prototype._cleanup=function(){'use strict';if(this._handle!==null)clearTimeout(this._handle);this._handle=null;this._cancelRequest=k;this._polling=false;};q.prototype._done=function(){'use strict';this._cleanup();this.inform('done',{sender:this});return this;};q.MIN_INTERVAL=2000;Object.assign(q.prototype,{_config:null,_requests:0,_muted:false,_polling:false,_skip:false,_cancelRequest:k});function r(){if(!this._polling)return;if(this._requests<this._config.maxRequests){var t=this._config.interval;t=typeof t==='function'?t(this._requests):t;t=t>q.MIN_INTERVAL?t:q.MIN_INTERVAL;if(this._config.clearOnQuicklingEvents){this._handle=n(this.request.bind(this),t);}else this._handle=m(this.request.bind(this),t);}else this._done();}function s(){return j.isLoggedInNow();}f.exports=q;},null);