/*!CK:2416356341!*//*1455565277,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["nIPWf"]); }

__d("XSouvenirMainDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/souvenir\/{id}\/",{id:{type:"Int"},story_fbid:{type:"Int"},__asyncDialog:{type:"Int"}});},null);
__d('SouvenirDialogUtils',['Animation','Arbiter','AsyncDialog','AsyncRequest','Bootloader','DOM','Ease','Event','Keys','LikeConfirmer','PageTransitions','ReactDOM','Scroll','URI','XSouvenirMainDialogController','destroyOnUnload','getActiveElement'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y=76,z={listenForClick:function(aa,ba,ca){var da=new u(ba).addQueryData({sdialog:1,theater:null}).getUnqualifiedURI().toString();this._registerPageTransition(da);var ea=o.listen(aa,'click',(function(event){this._nextURIString=da;this._previousURIString=new u(window.location.href).getUnqualifiedURI().toString();this._openDialog(ca);this._startJSFetch();new u(da).go();event.stopPropagation();event.preventDefault();}).bind(this));w(function(){return ea.remove();});},cleanupOnDismiss:function(aa,ba){aa.subscribe('hide',function(){ba&&s.unmountComponentAtNode(ba);});},initKeyBinders:function(aa){var ba=aa.subscribe('aftershow',(function(){aa.getRoot().focus();aa.getRoot().addEventListener('keydown',(function(ca){if(x()==aa.getRoot())this._handleKeyPress(ca);}).bind(this),false);ba.unsubscribe();}).bind(this));},_handleKeyPress:function(aa){var ba=m.find(document,'#souvenir_container');if(ba)switch(aa.keyCode){case p.SPACE:case p.PAGE_DOWN:case p.DOWN:case p.RIGHT:this.scrollDownByOnePage();break;case p.PAGE_UP:case p.UP:case p.LEFT:new h(ba).to('scrollTop',t.getTop(ba)-ba.clientHeight).ease(n.makePowerIn(3)).duration(500).go();break;case p.HOME:new h(ba).to('scrollTop',0).ease(n.makePowerIn(3)).duration(500).go();break;case p.END:new h(ba).to('scrollTop',ba.scrollHeight).ease(n.makePowerIn(3)).duration(500).go();break;case y:this.likeSouvenirWithKey();break;}},scrollDownByOnePage:function(){var aa=m.find(document,'#souvenir_container');new h(aa).to('scrollTop',t.getTop(aa)+aa.clientHeight).ease(n.makePowerIn(3)).duration(500).go();},pauseAndPlayWithDialog:function(aa){this._fireEventWithChange(aa,'show','fbPhotosSlideshow/pause',function(){r.transitionComplete();});this._fireEventWithChange(aa,'hide','fbPhotosSlideshow/play',(function(){if(this._previousURIString&&this._nextURIString)r.rewriteCurrentURI(this._nextURIString,this._previousURIString);}).bind(this));},likeSouvenirWithKey:function(){var aa=x();return q.like(this.likeSouvenir.bind(this,aa),aa);},likeSouvenir:function(aa){var ba=m.scry(aa,'button.like_link')[0];if(!ba)ba=m.scry(aa,'a.UFILikeLink')[0];ba.click();},_fireEventWithChange:function(aa,ba,ca,da){var ea=aa.subscribe(ba,function(){i.inform(ca);da();ea.unsubscribe();});},_registerPageTransition:function(aa){r.registerHandler((function(ba){if(ba.getUnqualifiedURI().toString()==aa)return true;this._registerPageTransition(aa);return false;}).bind(this));},_openDialog:function(aa){var ba=v.getURIBuilder().setInt('id',aa).getURI();j.send(new k(ba).setAllowCrossPageTransition(true));},_startJSFetch:function(){l.loadModules(["SouvenirPermaViewPage.react"],function(aa){});}};f.exports=z;},null);